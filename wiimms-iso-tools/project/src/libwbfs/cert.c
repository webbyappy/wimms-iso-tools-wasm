
/***************************************************************************
 *                    __            __ _ ___________                       *
 *                    \ \          / /| |____   ____|                      *
 *                     \ \        / / | |    | |                           *
 *                      \ \  /\  / /  | |    | |                           *
 *                       \ \/  \/ /   | |    | |                           *
 *                        \  /\  /    | |    | |                           *
 *                         \/  \/     |_|    |_|                           *
 *                                                                         *
 *                           Wiimms ISO Tools                              *
 *                         https://wit.wiimm.de/                           *
 *                                                                         *
 ***************************************************************************
 *                                                                         *
 *   This file is part of the WIT project.                                 *
 *   Visit https://wit.wiimm.de/ for project details and sources.          *
 *                                                                         *
 *   Copyright (c) 2009-2021 by Dirk Clemens <wiimm@wiimm.de>              *
 *                                                                         *
 ***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 *   This program is distributed in the hope that it will be useful,       *
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
 *   GNU General Public License for more details.                          *
 *                                                                         *
 *   See file gpl-2.0.txt or http://www.gnu.org/licenses/gpl-2.0.txt       *
 *                                                                         *
 ***************************************************************************/

#define _GNU_SOURCE 1
#include "dclib/dclib-basics.h"
#include "lib-bzip2.h"
#include "cert.h"

//
///////////////////////////////////////////////////////////////////////////////
///////////////			    data			///////////////
///////////////////////////////////////////////////////////////////////////////

cert_data_t root_cert =
{
    "",		// issuer
    0,		// key_type
    "Root",	// key_id
    0,		// unknown
 {
    //--- public_key (1024 bytes)

    0x24,0xf8,0xb0,0x84, 0x66,0x3b,0x8c,0xdf, 0xdd,0x27,0x6b,0x1e, 0x37,0x3c,0xdd,0xd9,
    0xad,0x06,0x4e,0xff, 0xa4,0x2c,0x8d,0x92, 0x1c,0xdf,0xc1,0x0c, 0x0e,0xc2,0x0f,0x0c,
    0xa2,0x20,0x59,0xfc, 0xb5,0x69,0x02,0x47, 0x65,0x8d,0x74,0x60, 0x4c,0x7e,0x98,0x4e,
    0xb1,0xeb,0x4e,0x49, 0x72,0x48,0xea,0x76, 0x7a,0x7f,0xde,0x8d, 0xd0,0xa7,0xc1,0x31,
    0x09,0x27,0xfc,0x5a, 0x41,0xa3,0xec,0xca, 0x2a,0x62,0xb9,0x0f, 0x5f,0x7d,0xb1,0x6f,
    0xee,0xc7,0x49,0xe9, 0xc4,0x4c,0x6d,0xac, 0xde,0x4f,0xa2,0x3d, 0x4f,0x29,0xa2,0x45,
    0x7e,0x9b,0x92,0x41, 0xe4,0xf8,0x1b,0x72, 0x3f,0x59,0x9d,0x29, 0xbb,0x3b,0x8d,0x50,
    0xa6,0xd2,0xe4,0x3b, 0x37,0x73,0x9d,0xc5, 0xc7,0x13,0x2d,0xa7, 0x9e,0x7a,0x68,0x31,

    0x3a,0x12,0x51,0x3b, 0xed,0x53,0xa3,0x8e, 0xd8,0x6f,0x45,0xd2, 0xfe,0xbb,0x99,0x73,
    0x08,0x59,0x6e,0x98, 0x4f,0xdc,0x57,0xd4, 0x1b,0x2a,0x6b,0x39, 0xb7,0xde,0x6f,0x34,
    0x22,0xd0,0x41,0x59, 0x40,0x64,0x6a,0x5e, 0xff,0x64,0x77,0xfb, 0x32,0x83,0xb9,0xe4,
    0xdb,0x57,0xf1,0x65, 0xc2,0xf6,0xc9,0xe2, 0x59,0x5d,0x5c,0xae, 0x7e,0xe7,0xb1,0x05,
    0xee,0x5d,0xd9,0x93, 0xb3,0x6c,0x2a,0x29, 0x71,0xf4,0xe2,0x16, 0xd7,0xa6,0x2f,0x88,
    0x89,0x3c,0xe1,0x7b, 0x6a,0x5f,0xfa,0x2f, 0x30,0x5f,0x96,0x2f, 0xc8,0xd8,0x56,0x1a,
    0x03,0xfc,0x0e,0x59, 0xd4,0xbb,0xe0,0x77, 0xbe,0x7e,0x1b,0x60, 0xcf,0xc6,0x8f,0xe2,
    0xd7,0xba,0x5c,0xb7, 0xc0,0xec,0xba,0x97, 0xeb,0xff,0xed,0x61, 0x18,0x6c,0x16,0x04,

    0x0d,0xc2,0x3b,0x67, 0x05,0xf4,0x89,0x94, 0x76,0x30,0xc3,0xba, 0x34,0xfd,0x6f,0x14,
    0x7c,0x9b,0xb5,0xdc, 0x19,0x3a,0x54,0x34, 0xd0,0x12,0xe0,0xbd, 0x0a,0x40,0x67,0x7d,
    0xeb,0x1a,0xbc,0x93, 0xa6,0xae,0x01,0x50, 0xa7,0xe2,0xe1,0x8d, 0xf5,0xd1,0x76,0xb6,
    0x85,0xa7,0xd4,0xc3, 0x41,0xea,0xef,0x7f, 0x9a,0xa6,0xe9,0xbd, 0xd5,0x70,0x7b,0x01,
    0xa1,0xf2,0xf3,0x6e, 0x1d,0x72,0x64,0x3e, 0xd3,0x94,0x4e,0x04, 0x65,0x24,0x68,0xb3,
    0x92,0xe0,0xcd,0x28, 0x28,0xa1,0x57,0xa9, 0xa1,0x22,0x22,0x7f, 0x55,0x40,0xef,0x85,
    0x80,0x82,0x21,0x37, 0x17,0x77,0x34,0x9d, 0xe2,0xe6,0x46,0x5c, 0xe0,0xb5,0xe9,0xb2,
    0x6e,0x6e,0x71,0x80, 0x18,0x14,0x84,0x99, 0x82,0x29,0x2b,0x6f, 0xda,0x98,0x68,0xa0,

    0xb8,0xda,0x50,0x03, 0x5c,0x43,0xaa,0xde, 0x86,0xf1,0x68,0x9a, 0x3c,0xe1,0xa0,0x2a,
    0xf3,0xe8,0x3b,0xde, 0x99,0xa7,0xde,0x78, 0x13,0x81,0x41,0x09, 0xe0,0x79,0xe6,0xa0,
    0x7a,0xf5,0xa4,0x50, 0xbb,0x16,0xd4,0x63, 0x30,0x16,0x9f,0x75, 0x8b,0x71,0xca,0x15,
    0x92,0xc0,0x04,0xa9, 0x16,0xcc,0xa1,0x12, 0xa2,0xdd,0xc4,0x2c, 0x03,0xb7,0x22,0x39,
    0xc1,0x07,0x05,0x4d, 0x1e,0xb2,0xbc,0x11, 0x94,0x84,0x76,0x85, 0xf0,0x5e,0xdc,0xa9,
    0x2e,0x43,0x8e,0xb0, 0x4d,0xa0,0xb3,0x39, 0x9c,0xe2,0x7b,0x08, 0x79,0xd0,0x30,0xe7,
    0xaf,0x58,0x02,0x54, 0xb2,0x5e,0x0e,0x37, 0x91,0x92,0x9e,0x69, 0x2e,0x6d,0x95,0x74,
    0xc2,0x7b,0x12,0xad, 0x98,0x00,0xf5,0x48, 0x13,0x18,0x92,0xc3, 0x4d,0x17,0x08,0x49,

    //---- post data
    0x00,0x01,0x00,0x01,
  }
};

///////////////////////////////////////////////////////////////////////////////

u8 std_cert_chain[0xa00] =
{
 /*     0 */  0xdc,0xdd,0xdc,0xdc, 0x6f,0x71,0x6f,0xfe, 0xb7,0xe0,0xe1,0x23, 0xc7,0x97,0x9c,0xab,
 /*    10 */  0xca,0x23,0x93,0xa6, 0x0b,0xb8,0x5a,0x14, 0x49,0x70,0x8a,0xf1, 0xfd,0x2d,0xda,0xdd,
 /*    20 */  0x08,0x2a,0xb8,0xf4, 0xc5,0xc0,0xdb,0xaa, 0x53,0x03,0xc6,0x3e, 0x12,0xa7,0xfb,0x15,
 /*    30 */  0xd3,0x60,0xd6,0x0c, 0xed,0xf9,0xa4,0x30, 0xdb,0xa5,0x6a,0x8b, 0x08,0xeb,0xf8,0xcf,
 /*    40 */  0x7b,0x24,0xb3,0xd0, 0xc8,0x1c,0x33,0xb2, 0xd5,0x9d,0x31,0xf7, 0xd9,0x30,0xe5,0x8b,
 /*    50 */  0xea,0xdb,0x55,0xdc, 0x96,0x5b,0x51,0xf2, 0x41,0x24,0x1b,0x79, 0x75,0x24,0x16,0x6f,
 /*    60 */  0xcd,0x6d,0xc4,0xa5, 0x8b,0x67,0x24,0x44, 0x3e,0x7e,0x88,0xde, 0x13,0x88,0xe5,0x13,
 /*    70 */  0xf7,0x63,0x7c,0x3d, 0x24,0x80,0xda,0xb2, 0x5f,0x46,0x3c,0x48, 0x16,0x9b,0x3c,0xc9,
 /*    80 */  0x84,0x29,0xb2,0xb3, 0xe8,0x35,0xf6,0x7e, 0x00,0xe4,0x4f,0xa2, 0xeb,0x11,0x50,0x80,
 /*    90 */  0x91,0x21,0xf3,0xcd, 0x93,0x34,0xb4,0x15, 0x74,0x05,0x22,0x04, 0xb2,0xd0,0xfd,0xa9,
 /*    a0 */  0x7e,0x61,0xa2,0x55, 0x65,0x1b,0x69,0xcf, 0x28,0xc6,0xa5,0xbd, 0x98,0xe5,0xcc,0x33,
 /*    b0 */  0x25,0x0b,0x22,0x8b, 0xfe,0xc4,0x09,0xb1, 0x27,0xa3,0x95,0xa6, 0x78,0x17,0x4c,0x08,
 /*    c0 */  0x2d,0x72,0x6d,0xaa, 0x38,0xb4,0x81,0x7b, 0x48,0x9c,0xbc,0x44, 0xf3,0xd8,0x94,0x9c,
 /*    d0 */  0xc3,0x13,0x1a,0x66, 0x37,0x06,0xca,0xec, 0x68,0xaf,0x68,0xc9, 0xff,0xe9,0xd4,0xdb,
 /*    e0 */  0xd6,0x43,0x93,0x55, 0xa4,0x3a,0xf0,0x30, 0x82,0x4e,0x9a,0x79, 0x74,0x61,0x7c,0x59,
 /*    f0 */  0xa4,0xb4,0xa9,0xd0, 0xe6,0xcd,0xf3,0x73, 0x49,0x34,0xe4,0x14, 0x45,0xd2,0x5b,0x6d,
 /*   100 */  0xbe,0x11,0xcc,0x06, 0x6f,0xed,0x4a,0xb9, 0x33,0x54,0x47,0x88, 0xc7,0x6f,0xea,0x67,
 /*   110 */  0xbb,0x8f,0x43,0x73, 0x1e,0x72,0xf1,0xd6, 0xf2,0xa9,0x1c,0xff, 0xa8,0x36,0x92,0x70,
 /*   120 */  0x51,0x45,0x8c,0xa3, 0x85,0x65,0x8f,0xab, 0xec,0x83,0xfa,0xe9, 0x1a,0xd4,0x75,0x4c,
 /*   130 */  0x4f,0x70,0x53,0x1a, 0x02,0xff,0x65,0xa6, 0x36,0xac,0x68,0x18, 0x13,0xba,0x6f,0xd2,
 /*   140 */  0x84,0xee,0xd2,0x19, 0x6a,0xae,0xd8,0x94, 0x12,0xe7,0x6d,0xc0, 0x8f,0xc3,0x17,0xac,
 /*   150 */  0xf4,0xa0,0x69,0x1e, 0xa0,0xbb,0x93,0x67, 0x21,0x50,0xa3,0x15, 0x9e,0xfc,0x78,0xaf,
 /*   160 */  0xff,0xc1,0x84,0xa2, 0x86,0xc6,0xc6,0x5e, 0x3f,0xa9,0xa5,0x7d, 0x67,0x5e,0xb2,0x12,
 /*   170 */  0xdd,0xad,0x15,0xa9, 0xbf,0x9b,0x97,0xc1, 0x9a,0x3a,0xa5,0x6e, 0x5e,0xeb,0xbe,0xcd,
 /*   180 */  0x11,0x1b,0xdc,0xf3, 0x9a,0x5b,0x1e,0xe0, 0xb1,0x1c,0x09,0x69, 0xa4,0xb2,0x3d,0x2e,
 /*   190 */  0xaf,0x23,0xdd,0x4e, 0x8c,0xd3,0x28,0x1b, 0x8c,0xb6,0x32,0xae, 0x6a,0x28,0xe1,0x2a,
 /*   1a0 */  0xd4,0x22,0x79,0x5f, 0x7d,0x25,0x5a,0xd3, 0x5b,0x73,0x8e,0x98, 0x88,0x67,0x9b,0x1f,
 /*   1b0 */  0xda,0xd0,0x48,0x35, 0x47,0x2b,0x0a,0xee, 0x7b,0x14,0x77,0x97, 0x93,0x29,0xe9,0xfd,
 /*   1c0 */  0xc3,0x1d,0x5c,0x9b, 0x67,0xa6,0x26,0x86, 0xf7,0x0b,0x64,0x58, 0x71,0x52,0x8a,0x93,
 /*   1d0 */  0x87,0x55,0x23,0xeb, 0x4b,0xeb,0x2d,0x29, 0xdd,0xe7,0xc3,0x42, 0x18,0xc4,0xb3,0x4e,
 /*   1e0 */  0xf6,0x09,0x18,0x6f, 0x1c,0x09,0x5b,0xd7, 0x40,0xd8,0x73,0xc6, 0x69,0x2f,0x60,0xb1,
 /*   1f0 */  0xd6,0x2d,0xa1,0x9b, 0xd4,0x38,0x9f,0x35, 0xaf,0x2b,0x6b,0xac, 0xab,0x88,0x66,0x2f,
 /*   200 */  0x30,0x0e,0x70,0x95, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   210 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   220 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   230 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   240 */  0x8e,0xb3,0xb3,0xa8, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   250 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   260 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   270 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   280 */  0xdc,0xdc,0xdc,0xdd, 0x9f,0x9d,0xec,0xec, 0xec,0xec,0xec,0xec, 0xec,0xed,0xdc,0xdc,
 /*   290 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   2a0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   2b0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   2c0 */  0xdc,0xdc,0xdc,0xdc, 0x87,0x26,0xa1,0x80, 0x6e,0xa5,0x15,0x3e, 0x32,0x3d,0xfd,0x1a,
 /*   2d0 */  0x36,0x28,0x93,0x2a, 0xe5,0x24,0x53,0xdb, 0x57,0x97,0xab,0x31, 0x43,0x49,0xbc,0x6c,
 /*   2e0 */  0xe9,0x5e,0x5d,0x69, 0xd2,0x89,0x77,0xae, 0xcd,0xc9,0x7d,0xab, 0xac,0xe0,0xa6,0xec,
 /*   2f0 */  0x22,0xe6,0x35,0x33, 0xc0,0xbc,0x60,0xc1, 0x4b,0x9a,0xaa,0x6e, 0xe6,0xb4,0x10,0xd8,
 /*   300 */  0x6d,0x44,0x8e,0x87, 0x15,0xb4,0x2d,0xc1, 0x3e,0x07,0x8c,0x38, 0x05,0x3b,0x2c,0xad,
 /*   310 */  0x39,0xbe,0x06,0x3e, 0xd5,0xfe,0xef,0x35, 0x0f,0xbf,0x2a,0xc1, 0x0b,0x1d,0x43,0x2f,
 /*   320 */  0x78,0x75,0xc2,0x53, 0xb9,0x8f,0x08,0xad, 0x01,0xa7,0x58,0x65, 0x2d,0x64,0x12,0xaf,
 /*   330 */  0xe9,0x2c,0x29,0x88, 0xd9,0xbf,0x7d,0x36, 0x64,0xe5,0xbf,0x3c, 0x47,0x35,0xdd,0xdd,
 /*   340 */  0xc3,0x45,0x88,0xbf, 0xbd,0xf4,0xac,0xfc, 0x35,0x10,0xd1,0x77, 0x94,0xa3,0xc8,0xd1,
 /*   350 */  0xba,0xfa,0x7d,0x5f, 0xb1,0xfb,0xcd,0xc3, 0xfc,0xb4,0x02,0x9b, 0xae,0xc8,0x4d,0x8d,
 /*   360 */  0x13,0xb5,0x1a,0xc7, 0x7a,0xd2,0x25,0x05, 0x95,0x7c,0x2b,0xc3, 0x88,0x45,0x2e,0x0f,
 /*   370 */  0x46,0x0e,0x50,0xac, 0xd9,0xe8,0x5e,0x4f, 0x18,0xed,0x23,0x61, 0xef,0x2a,0x60,0x7a,
 /*   380 */  0xd1,0x1b,0xc5,0x82, 0x7e,0x60,0x19,0xb1, 0xfc,0xd7,0x73,0xb1, 0xda,0x0c,0x40,0x9d,
 /*   390 */  0x07,0x51,0x35,0x1b, 0xfc,0xc9,0x90,0x78, 0x5f,0xf7,0xb5,0x1c, 0x50,0xb5,0x11,0xe7,
 /*   3a0 */  0xdb,0xe6,0xdc,0xbf, 0xbc,0xf3,0x9a,0xf1, 0xef,0x5c,0xbd,0x79, 0x36,0xb0,0x4d,0x80,
 /*   3b0 */  0x09,0xbe,0xe9,0xa5, 0x1f,0x37,0xb8,0x12, 0x98,0x33,0x84,0xb1, 0xc8,0x66,0x76,0x54,
 /*   3c0 */  0xe8,0xdd,0x47,0xe2, 0x37,0x32,0x0f,0xa5, 0xdc,0xdd,0xdc,0xdd, 0xdc,0xdc,0xdc,0xdc,
 /*   3d0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   3e0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   3f0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   400 */  0xdc,0xdd,0xdc,0xdd, 0x92,0xdc,0x83,0x2d, 0xe3,0x5a,0xa9,0x51, 0x6a,0x40,0x99,0xbf,
 /*   410 */  0xd3,0x08,0x47,0x28, 0x10,0x81,0x88,0x13, 0x10,0xfe,0xe8,0xae, 0x8b,0x77,0x78,0x66,
 /*   420 */  0x8f,0x0e,0x6f,0xe1, 0x3a,0x30,0x42,0x7d, 0x8b,0x88,0x8f,0x72, 0x83,0x4f,0xe1,0x4a,
 /*   430 */  0x63,0x2b,0x10,0xa6, 0xa5,0x8a,0xb2,0x58, 0xa7,0xc7,0xbc,0xab, 0x1e,0x75,0xe4,0xad,
 /*   440 */  0xec,0xc6,0x50,0x0f, 0x15,0xe1,0x91,0x6f, 0xfa,0x35,0x5b,0x4e, 0xba,0x35,0x0f,0x66,
 /*   450 */  0x43,0xa5,0x60,0x9a, 0xe4,0x26,0xf1,0xfc, 0x7c,0xe6,0xac,0xbb, 0x78,0xcd,0x7b,0x7c,
 /*   460 */  0x6b,0x05,0xce,0x71, 0xcd,0xb6,0xe6,0x18, 0xb2,0xee,0x9e,0x9b, 0x1e,0xd4,0x66,0x68,
 /*   470 */  0x48,0x40,0x19,0xf2, 0x0c,0xf3,0xc5,0x2a, 0x8d,0x3c,0x03,0xf2, 0xea,0x8f,0x76,0x73,
 /*   480 */  0x4b,0x7a,0x4e,0x67, 0x75,0xc1,0x04,0xb2, 0xf8,0xf2,0x6f,0xd4, 0xab,0x89,0xcd,0x12,
 /*   490 */  0x44,0x2a,0x7e,0x28, 0xfa,0x15,0xfb,0xd8, 0x0c,0x20,0x51,0x08, 0x5c,0x42,0x0b,0xbd,
 /*   4a0 */  0x61,0xcd,0x6b,0x59, 0x48,0x50,0x0a,0x0c, 0xa6,0x07,0x78,0xd4, 0x0c,0x2c,0x5a,0x2a,
 /*   4b0 */  0x86,0x72,0xc5,0xc8, 0x6e,0x54,0x46,0x74, 0x72,0x96,0x7e,0x76, 0x1b,0xbd,0x75,0xd1,
 /*   4c0 */  0x9d,0xf0,0x6d,0x8c, 0xd5,0x77,0xe2,0x4f, 0x20,0x75,0xf8,0x02, 0x12,0x93,0xa0,0xda,
 /*   4d0 */  0x77,0x00,0xf2,0xbc, 0x41,0xb4,0x62,0xdc, 0xaf,0x26,0x5c,0x8b, 0xb6,0xc8,0x82,0x31,
 /*   4e0 */  0x18,0x57,0xa8,0xee, 0x5b,0xdb,0x4f,0x14, 0x20,0x7a,0x04,0xe2, 0xd5,0xb2,0x19,0x2e,
 /*   4f0 */  0x75,0x18,0xfd,0x3b, 0x94,0x6f,0xaf,0x9c, 0x87,0x3e,0x26,0x56, 0x3d,0x84,0xa4,0x35,
 /*   500 */  0x09,0xff,0x54,0xa9, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   510 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   520 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   530 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   540 */  0x8e,0xb3,0xb3,0xa8, 0xf1,0x9f,0x9d,0xec, 0xec,0xec,0xec,0xec, 0xec,0xec,0xed,0xdc,
 /*   550 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   560 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   570 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   580 */  0xdc,0xdc,0xdc,0xdd, 0x9f,0x8c,0xec,0xec, 0xec,0xec,0xec,0xec, 0xec,0xe8,0xdc,0xdc,
 /*   590 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   5a0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   5b0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   5c0 */  0xdc,0xdc,0xdc,0xdc, 0x2d,0x64,0x7c,0xb8, 0x1d,0xb1,0x2f,0x5f, 0xf5,0x89,0x1f,0xf5,
 /*   5d0 */  0x87,0xae,0x2c,0xef, 0xf2,0x4b,0x33,0xc8, 0x58,0x56,0xb4,0xd8, 0x40,0x7a,0x52,0x70,
 /*   5e0 */  0x02,0xc8,0x8c,0xef, 0x64,0xb0,0xcc,0x51, 0x94,0xef,0x80,0x81, 0xd0,0x77,0xab,0xd8,
 /*   5f0 */  0xbe,0x88,0x9b,0x89, 0x99,0xf6,0x4c,0xdc, 0xac,0x6d,0x8a,0x4e, 0x80,0xcb,0x5a,0x3e,
 /*   600 */  0x11,0xfc,0xb1,0x10, 0x00,0xf0,0xf2,0xeb, 0xb2,0xfb,0x20,0x68, 0xfc,0xba,0x10,0xd6,
 /*   610 */  0x50,0x35,0x22,0x34, 0x8b,0xd8,0x3a,0x16, 0xbf,0xc6,0xf2,0xa2, 0x4d,0xa2,0x48,0xa0,
 /*   620 */  0xe5,0x4d,0xab,0xea, 0xf5,0x0d,0x89,0xbd, 0x59,0x67,0x0b,0x6b, 0xaf,0x16,0xeb,0x9b,
 /*   630 */  0x42,0x83,0x76,0x7f, 0x6a,0xd9,0x3c,0xdd, 0x3d,0x70,0x39,0x51, 0x04,0x24,0x9b,0x5e,
 /*   640 */  0x0a,0x99,0x20,0x3f, 0x7d,0x11,0xdf,0x77, 0xea,0x2c,0x2f,0x5a, 0x6d,0x7e,0x0d,0xeb,
 /*   650 */  0x9c,0x7d,0x48,0x56, 0x8f,0x66,0xc7,0xd1, 0x50,0x94,0xbf,0x11, 0xb7,0xf0,0xf2,0xfc,
 /*   660 */  0xb8,0x48,0x5c,0x90, 0xbe,0x26,0x75,0xe6, 0xa2,0xef,0x75,0x36, 0xa4,0xb7,0x85,0x16,
 /*   670 */  0x3f,0x77,0xea,0x99, 0x28,0x17,0x53,0x0b, 0x4c,0xb7,0x5e,0xb4, 0x11,0x70,0x2d,0xa7,
 /*   680 */  0xe6,0x30,0x9a,0x5f, 0xc7,0x4d,0x2a,0x02, 0xc4,0xbd,0x5f,0x60, 0x97,0xee,0xbb,0x4f,
 /*   690 */  0x1b,0xf2,0x8c,0x05, 0xc2,0xea,0x7c,0x00, 0x3e,0x65,0xa1,0x7c, 0xfd,0xe2,0x9a,0x4a,
 /*   6a0 */  0xde,0xc3,0xef,0xc0, 0x62,0x72,0x51,0x20, 0x4e,0x5b,0xee,0x76, 0x98,0x00,0xa4,0x3b,
 /*   6b0 */  0xc5,0x46,0xe1,0x01, 0x8b,0xfe,0xa2,0x42, 0xab,0x02,0xee,0xbf, 0x5a,0x4f,0xb0,0xcd,
 /*   6c0 */  0x70,0x7b,0xd3,0x5d, 0xc5,0x0f,0xe6,0x45, 0xdc,0xdd,0xdc,0xdd, 0xdc,0xdc,0xdc,0xdc,
 /*   6d0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   6e0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   6f0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   700 */  0xdc,0xdd,0xdc,0xdd, 0xa1,0x41,0x82,0x66, 0x8e,0x5d,0x00,0x7b, 0xda,0x81,0xf3,0xd4,
 /*   710 */  0xb4,0x07,0x56,0x1b, 0xe6,0x12,0xa2,0x75, 0x4d,0x2d,0x4a,0x43, 0x3d,0x0c,0x2e,0x1d,
 /*   720 */  0xc3,0x72,0x1c,0x1f, 0x2c,0xc6,0x00,0x68, 0x9a,0x71,0x39,0x16, 0xdf,0x6a,0xf9,0xfd,
 /*   730 */  0x48,0xbe,0x1a,0x3d, 0x9d,0xd1,0x65,0x3a, 0xe3,0x02,0x44,0x0d, 0x73,0xfa,0xe7,0x90,
 /*   740 */  0x6e,0x5b,0x58,0xfb, 0x5e,0xae,0x33,0xfb, 0xcf,0x97,0x5b,0x1e, 0x84,0x0a,0xa7,0xbe,
 /*   750 */  0x2e,0x69,0x63,0x40, 0x6a,0x66,0x50,0x55, 0xc5,0xf2,0x19,0xda, 0x55,0x70,0xa8,0xf8,
 /*   760 */  0x7c,0xfe,0xd5,0x9c, 0xdf,0x32,0x44,0x78, 0x61,0xf3,0xdd,0xe7, 0x85,0xe3,0x39,0xba,
 /*   770 */  0xb0,0x09,0x37,0x86, 0x0b,0x78,0x4f,0xcc, 0x2f,0x92,0x27,0x68, 0xe1,0x9a,0x17,0x2d,
 /*   780 */  0x69,0xff,0x13,0x5e, 0x2a,0x52,0x69,0xb1, 0x65,0xd8,0x7b,0x1e, 0x74,0xf7,0x3d,0xc1,
 /*   790 */  0xa4,0x0f,0x47,0x7e, 0xd1,0x4c,0x0f,0xdb, 0x9e,0x07,0x82,0xa6, 0x1d,0x33,0x2e,0xfd,
 /*   7a0 */  0x8d,0xd5,0xbe,0x13, 0x75,0xc8,0x74,0x5c, 0x00,0x28,0xcb,0x66, 0x45,0x4f,0xd6,0x32,
 /*   7b0 */  0xd4,0x6c,0x6c,0x39, 0xc6,0xe2,0x43,0x73, 0x11,0x1e,0x0b,0x3f, 0x17,0x7d,0xf3,0xe6,
 /*   7c0 */  0x1c,0xdb,0x4c,0x02, 0x98,0xa6,0x1f,0x19, 0xe4,0x74,0xbb,0x4e, 0xe4,0xdb,0x57,0x08,
 /*   7d0 */  0x18,0x6e,0x99,0x70, 0xf5,0xca,0x54,0xb1, 0xf6,0xd2,0x85,0x92, 0x31,0x80,0x14,0xe9,
 /*   7e0 */  0xb5,0x57,0x91,0xbe, 0xe4,0x03,0xd9,0xae, 0x91,0x10,0x2a,0x5d, 0x5c,0x56,0xac,0xa8,
 /*   7f0 */  0xda,0x85,0xec,0x63, 0x24,0x8d,0x9d,0xeb, 0x34,0xc9,0x26,0x66, 0x7d,0xae,0x64,0x3c,
 /*   800 */  0xb5,0xb0,0xbd,0x38, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   810 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   820 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   830 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   840 */  0x8e,0xb3,0xb3,0xa8, 0xf1,0x9f,0x9d,0xec, 0xec,0xec,0xec,0xec, 0xec,0xec,0xed,0xdc,
 /*   850 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   860 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   870 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   880 */  0xdc,0xdc,0xdc,0xdd, 0x84,0x8f,0xec,0xec, 0xec,0xec,0xec,0xec, 0xec,0xef,0xdc,0xdc,
 /*   890 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   8a0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   8b0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   8c0 */  0xdc,0xdc,0xdc,0xdc, 0x2d,0x64,0x43,0x0d, 0x71,0xdb,0x75,0xeb, 0x56,0xa7,0xcc,0xd0,
 /*   8d0 */  0xa1,0x1b,0xe5,0x62, 0x42,0x01,0x6b,0xee, 0xdc,0x55,0x77,0xf9, 0x6d,0x24,0xad,0x73,
 /*   8e0 */  0x86,0x75,0x28,0x84, 0x42,0x0d,0x5f,0xde, 0xee,0x52,0x5d,0xc6, 0xc3,0x33,0x0c,0xd5,
 /*   8f0 */  0x14,0xda,0xea,0x9f, 0x24,0x88,0x65,0x3d, 0xe7,0x67,0xbd,0xe6, 0xa6,0x13,0x5b,0xc8,
 /*   900 */  0x59,0xb7,0x78,0x87, 0x76,0x3b,0x67,0x1a, 0x92,0x6e,0x2b,0x81, 0x5b,0x37,0x2e,0xbb,
 /*   910 */  0x31,0xd3,0x78,0x9d, 0x75,0xef,0xba,0x82, 0x8b,0xa1,0x86,0x02, 0x77,0x27,0x9a,0xf2,
 /*   920 */  0xaa,0xdc,0x16,0x40, 0x35,0x91,0x18,0x17, 0x44,0xe5,0x4e,0x77, 0xa6,0xf3,0x6f,0x7f,
 /*   930 */  0x42,0x7e,0x63,0x40, 0x8f,0x30,0x0c,0x00, 0x26,0xb7,0x57,0x82, 0x6e,0x17,0x78,0xd3,
 /*   940 */  0x26,0x9c,0xa9,0x24, 0x2e,0x6e,0x02,0x4b, 0xe4,0xcd,0x5b,0xf1, 0x29,0x3e,0x7a,0x1f,
 /*   950 */  0x57,0xf3,0x00,0x52, 0x8b,0x01,0x61,0x83, 0x9a,0x37,0xfb,0x0a, 0xc5,0x8e,0x2a,0x72,
 /*   960 */  0x24,0xbe,0x6b,0x32, 0x46,0x1a,0x5e,0x7e, 0x6d,0x46,0x75,0x69, 0x84,0x27,0x37,0x6f,
 /*   970 */  0x55,0xf3,0x61,0x8c, 0x15,0x29,0x00,0x96, 0xb2,0x40,0x47,0x22, 0x99,0x5c,0xe8,0x75,
 /*   980 */  0x9e,0xc4,0xf1,0x02, 0x6b,0x83,0x3c,0x0d, 0x6f,0x03,0xd2,0x4b, 0x3f,0x45,0x5c,0x5b,
 /*   990 */  0xac,0xc4,0x1e,0x6e, 0x5f,0x2d,0xe9,0xa9, 0xa0,0x86,0xec,0x20, 0xe3,0xec,0x58,0x78,
 /*   9a0 */  0x46,0x76,0x1c,0xc2, 0x3b,0xda,0xb5,0x93, 0x52,0xc8,0x94,0x06, 0xce,0xe6,0x10,0x93,
 /*   9b0 */  0x26,0xfa,0x76,0xe4, 0x2b,0x33,0x63,0xfb, 0x53,0xea,0x4b,0xa5, 0xab,0x81,0x6b,0x19,
 /*   9c0 */  0x71,0x1b,0x55,0x4d, 0x00,0x24,0x9f,0x51, 0xdc,0xdd,0xdc,0xdd, 0xdc,0xdc,0xdc,0xdc,
 /*   9d0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   9e0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
 /*   9f0 */  0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc, 0xdc,0xdc,0xdc,0xdc,
};

///////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////

static const u8 cert_ca00000001_bz2[] =
{
  // decompressed size: 0x400 = 1024 bytes
  0x00,0x00,0x04,0x00,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0xba,0x4e, 0x10,0xfc,0x00,0x00,
  0x07,0x7f,0xff,0xff, 0xff,0xef,0x7f,0xff, 0xdf,0xff,0xff,0x7d, 0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff, 0xef,0xff,0xff,0xf7, 0xff,0xff,0xfe,0xff, 0xff,0xdf,0xff,0xff,
  0xff,0xff,0xfb,0xc0, 0x02,0x3c,0xee,0xb6, 0xdc,0x31,0x49,0x34, 0xda,0x4c,0x08,0xcd,
  0x00,0x10,0xc2,0x66, 0x80,0x0d,0x00,0x83, 0x4c,0x01,0x3d,0x26, 0x00,0x35,0x34,0xc9,
  0xb4,0x00,0x00,0x26, 0x4c,0x04,0xd3,0x00, 0x03,0x40,0x27,0xa4, 0x60,0xd0,0x01,0xa0,
  0x4c,0x4f,0x44,0xc6, 0x9a,0x00,0x1a,0x00, 0x34,0x34,0xd0,0x00, 0x68,0x1a,0x9b,0x53,
  0xf5,0x10,0x68,0x00, 0x03,0x40,0x8d,0x30, 0x13,0x34,0x4d,0xa0, 0x47,0xa0,0x23,0x6a,
  0x36,0x8d,0x09,0x86, 0x53,0x09,0x80,0x00, 0x98,0x00,0x11,0xa3, 0x0f,0x50,0x98,0x00,
  0xd0,0x00,0xd0,0x46, 0x0d,0x04,0xd3,0x4d, 0xa3,0xd4,0x00,0x8c, 0x00,0x01,0x31,0xa4,
  0xc1,0x30,0x09,0x80, 0x34,0x19,0x4c,0x80, 0x00,0x00,0xd0,0x00, 0x00,0x00,0x00,0x00,
  0x00,0x1a,0x00,0x00, 0x00,0x1a,0x1a,0x00, 0x68,0x00,0x00,0x00, 0x00,0xc8,0x00,0x00,
  0x00,0x00,0x00,0x00, 0x00,0x00,0x00,0x00, 0x03,0x40,0x2a,0xa4, 0xcf,0x53,0x29,0x86,
  0x9a,0x26,0x01,0x30, 0x0d,0x26,0x1a,0x4c, 0x00,0x98,0xd0,0x00, 0x02,0x60,0x69,0xa1,
  0xa8,0xd3,0x00,0x23, 0x00,0x34,0x00,0x98, 0x9a,0x30,0x4c,0x13, 0x00,0x26,0x00,0x13,
  0x00,0x98,0x02,0x60, 0x26,0x00,0x00,0x4c, 0x01,0x30,0x0d,0x13, 0x09,0x9e,0x44,0x55,
  0x97,0xb0,0x80,0x00, 0x04,0x04,0x78,0x0c, 0x00,0x80,0x08,0xe1, 0x84,0xa0,0x06,0xf8,
  0x72,0x2a,0x99,0x1e, 0x03,0x0c,0x07,0x16, 0x28,0xc0,0xd0,0x64, 0x10,0x0c,0x33,0xa3,
  0x0d,0xcc,0x81,0xe1, 0x72,0x57,0x22,0xef, 0xd9,0x7b,0xf6,0x3b, 0xaf,0x7a,0x1d,0x81,
  0x13,0x08,0x4c,0xc2, 0xc4,0x50,0x78,0xc3, 0xa1,0x86,0xf5,0xf7, 0xb7,0x95,0x03,0x42,
  0x9b,0xca,0x78,0xcd, 0xf6,0xa0,0xb4,0xa5, 0x0b,0x2b,0x88,0x1a, 0x26,0x63,0xca,0x6a,
  0xb3,0x7e,0x6d,0xba, 0xc1,0xfc,0x95,0xcb, 0xc0,0x1f,0xee,0x57, 0x8a,0xf8,0x68,0xc9,
  0xe9,0x51,0x41,0x4d, 0x6a,0x1d,0xf5,0x82, 0x72,0x41,0x45,0x50, 0xc6,0x27,0xf9,0x02,
  0xa0,0xe9,0x16,0xfe, 0x64,0x52,0xea,0x10, 0x0a,0x91,0xb7,0x62, 0x8c,0x7b,0x62,0x00,
  0x50,0x5b,0x1d,0x81, 0x1b,0x66,0x27,0x80, 0x53,0xcf,0x4e,0x80, 0x6d,0xb4,0xe8,0xaf,
  0xd6,0x11,0xc9,0x95, 0x3d,0x2d,0x08,0x46, 0xf0,0xad,0x34,0x02, 0x88,0x47,0xd2,0xd9,
  0x85,0xe0,0x2b,0xe1, 0xf6,0x53,0x18,0x47, 0x9b,0x6e,0x87,0x62, 0xd4,0x04,0x07,0xa1,
  0x5f,0x16,0xcc,0xf9, 0x71,0x0a,0xc7,0xbb, 0x80,0x8d,0xb5,0xc0, 0x3f,0xee,0xf4,0xa3,
  0x83,0xde,0x63,0x5e, 0x08,0xa9,0xb9,0xfc, 0x38,0x0d,0x7e,0x3a, 0xeb,0x95,0x39,0xbe,
  0x97,0x42,0xab,0x35, 0xb2,0xae,0x51,0x86, 0x04,0x7f,0xcc,0x0d, 0x99,0x14,0x01,0x80,
  0x92,0xd5,0x26,0x25, 0xd3,0x36,0x2f,0x27, 0x48,0x5d,0xf1,0x2e, 0x08,0x6f,0x03,0xdf,
  0xad,0x30,0x7c,0x57, 0x29,0x92,0x23,0x93, 0x74,0x2f,0x59,0xc5, 0x21,0x1b,0x3c,0xc9,
  0xf3,0x65,0xc4,0x8f, 0xb2,0x9e,0xdc,0x11, 0xfa,0xd5,0x62,0x4b, 0x75,0x10,0x41,0xb5,
  0x6a,0xb0,0x56,0x62, 0xac,0xbd,0x46,0xd8, 0x6f,0x92,0x48,0xa1, 0x7e,0xbf,0xfd,0xf2,
  0xd5,0x29,0x4f,0xda, 0xd2,0x56,0x3b,0x40, 0xe8,0x11,0x32,0x5a, 0x61,0x8b,0xd0,0xbd,
  0x31,0xfc,0xb3,0x7d, 0x55,0xbe,0xa6,0xf7, 0xc4,0x9e,0x67,0x1e, 0x7e,0xbb,0x2d,0x7b,
  0xa5,0x42,0x43,0x1a, 0x49,0x3c,0x90,0xaa, 0x6e,0x04,0xd4,0x35, 0x87,0xc8,0x6a,0xfd,
  0x44,0x3f,0x94,0xb8, 0x23,0x24,0x9f,0x65, 0x5b,0x87,0xf2,0x64, 0x5b,0x94,0x88,0x8c,
  0x82,0x5a,0xff,0x55, 0x9f,0x12,0x70,0x70, 0xa1,0xd6,0x5c,0x5c, 0xc3,0xf7,0x3d,0x5b,
  0x86,0xfb,0x01,0x24, 0xb0,0x74,0x1e,0xc3, 0x52,0x34,0x32,0x98, 0x1b,0x18,0xaf,0x07,
  0x9e,0xab,0xcc,0x4c, 0xd6,0x20,0x97,0x6c, 0xa2,0xce,0x06,0x4d, 0x2b,0xe3,0xb9,0xc1,
  0xb1,0xa3,0x7f,0xa6, 0x82,0xdd,0xbb,0xf1, 0x2f,0x53,0x4e,0x80, 0x1b,0xd6,0x57,0x4d,
  0x74,0xf0,0x19,0xee, 0x5a,0x12,0xa2,0x3a, 0xe1,0x4a,0x5b,0x82, 0x80,0x5d,0x33,0x11,
  0xd2,0x89,0x55,0xec, 0x6a,0x4b,0x49,0x88, 0xde,0x2f,0xa8,0xfe, 0x96,0xfd,0x90,0x91,
  0x9b,0x2a,0x1c,0x88, 0x2e,0x7c,0x77,0x0d, 0x1e,0x66,0x7e,0x47, 0x0a,0x0e,0x94,0xfe,
  0xdc,0xf1,0x9f,0xa2, 0xd0,0x19,0x52,0x22, 0x70,0xdb,0xcf,0xcc, 0x47,0xd2,0x49,0xb5,
  0x42,0x9d,0xdf,0x03, 0x77,0x25,0x84,0x20, 0xd3,0x17,0x21,0xd1, 0x8d,0x94,0xb0,0x71,
  0x58,0x02,0x67,0xce, 0x88,0x84,0x11,0xbd, 0x27,0xc4,0x06,0x4d, 0x52,0xfd,0x90,0xd9,
  0x6b,0xa2,0x95,0x9c, 0x2d,0xb1,0x3f,0x1d, 0xd2,0xff,0xfd,0x1a, 0x81,0x40,0xc2,0xfa,
  0x1f,0x8a,0xe4,0x42, 0x41,0xe0,0x34,0xa9, 0x8e,0x5e,0xf7,0x0d, 0x23,0xe3,0xd3,0x32,
  0x69,0xc1,0x50,0xd6, 0x1e,0xde,0x4b,0xd3, 0x69,0xa4,0x42,0xe6, 0x64,0xaa,0x73,0xfd,
  0x8c,0x39,0xb8,0xb2, 0x64,0xa9,0xed,0x91, 0x3a,0xe9,0x44,0x84, 0x78,0x26,0x1f,0xc1,
  0xc7,0x4f,0x21,0xa9, 0x0f,0x12,0x9e,0x2c, 0x1c,0x3c,0x90,0x85, 0x48,0x8c,0xeb,0x58,
  0xdb,0x3e,0x72,0x43, 0x11,0x4f,0x00,0x80, 0x94,0x54,0x4a,0x69, 0x01,0x92,0x23,0x8f,
  0x41,0xbb,0xad,0x90, 0x64,0x7e,0xcd,0x85, 0xfa,0x71,0x01,0x15, 0xc5,0x8f,0x2f,0xdd,
  0x65,0xe1,0xd6,0x37, 0x48,0x71,0x31,0x3b, 0xfe,0xa0,0xc7,0x34, 0x52,0x54,0xd0,0x8f,
  0x83,0xc2,0xe8,0x1b, 0xda,0x79,0x19,0x7c, 0x53,0x2c,0x2d,0xc5, 0xc0,0xa8,0xf9,0xc9,
  0x67,0x42,0x34,0xa5, 0x80,0x34,0xc5,0x2e, 0xcd,0xd4,0x80,0x13, 0x11,0x87,0x18,0x98,
  0x64,0x7f,0xf3,0x22, 0x93,0x50,0x7f,0x40, 0xb4,0x79,0x34,0x60, 0xe4,0x1f,0x75,0x1d,
  0xd0,0xa3,0x47,0xc7, 0x42,0xd9,0x85,0xc3, 0x94,0xd7,0x8d,0x75, 0x25,0xf7,0xdb,0x5d,
  0xa7,0x9a,0x23,0x94, 0x4e,0x65,0x45,0xfb, 0xc6,0x4c,0x77,0x69, 0xfe,0x87,0x64,0x08,
  0x7c,0xb2,0x9e,0x55, 0x31,0x5b,0x3e,0xcd, 0xb5,0x60,0x1d,0x9d, 0x55,0xc3,0x10,0x10,
  0xdd,0xd7,0xb9,0x3f, 0x04,0x84,0x2b,0x3e, 0x4a,0x36,0x49,0x47, 0x43,0x14,0xb2,0xf8,
  0x20,0x69,0xeb,0xb3, 0xaa,0xc7,0x4f,0xc2, 0x07,0x80,0x34,0x28, 0xe8,0x85,0x58,0x19,
  0x00,0x0c,0xe8,0x7e, 0xfe,0xf1,0x61,0x7c, 0x13,0x04,0xee,0xbb, 0xc5,0xdc,0x91,0x4e,
  0x14,0x24,0x2e,0x93, 0x84,0x3f,0x00,
  // 0x417 = 1047 data bytes (103%)
};

///////////////////////////////////////////////////////////////////////////////

static const u8 cert_ca00000002_bz2[] =
{
  // decompressed size: 0x400 = 1024 bytes
  0x00,0x00,0x04,0x00,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0x96,0x6e, 0xc6,0x6f,0x00,0x00,
  0x07,0x7f,0xff,0xff, 0xff,0xff,0xfb,0xfb, 0xff,0xff,0xdf,0xff, 0xf7,0xfd,0xfb,0xff,
  0xff,0xfe,0xff,0xef, 0xff,0xff,0xfd,0xff, 0xff,0xff,0xdf,0xff, 0xff,0xff,0xdf,0xff,
  0xff,0xff,0xeb,0xc0, 0x02,0x3d,0xb6,0xdd, 0x5c,0xd3,0xae,0x90, 0x68,0xd1,0xa4,0xc8,
  0xc9,0x93,0xc8,0x9a, 0x3d,0x4c,0x01,0x0d, 0x34,0xc0,0x46,0x9a, 0x33,0x21,0xa0,0x11,
  0xa6,0x9a,0x6d,0x47, 0xa4,0xda,0x06,0x9a, 0x43,0x11,0x84,0x68, 0x79,0x4c,0xc9,0xa0,
  0x11,0xb4,0x4d,0xa4, 0xf4,0x13,0xd2,0x60, 0x26,0xd2,0x64,0xc4, 0x0d,0x3c,0x9a,0x4c,
  0x03,0x4d,0x10,0xd1, 0x8c,0x42,0x31,0xa3, 0x26,0x9a,0x27,0x93, 0x4c,0x49,0xa6,0x3a,
  0x00,0xc8,0x00,0x00, 0x0d,0x00,0xd0,0x00, 0x00,0x00,0x00,0x00, 0x00,0x06,0x80,0x00,
  0x00,0x00,0x00,0x03, 0x40,0x00,0x01,0xa1, 0xa0,0x06,0x80,0x00, 0x00,0x00,0x00,0x00,
  0x1a,0x00,0x00,0x40, 0x00,0x06,0x83,0x40, 0x68,0x00,0xd0,0x00, 0xc8,0x00,0x00,0x00,
  0x00,0xd0,0x00,0x0d, 0x00,0x00,0x00,0x00, 0x00,0x03,0x40,0x00, 0xd0,0x00,0x00,0x00,
  0x00,0x00,0x00,0x00, 0x00,0x00,0x0d,0x0a, 0xa2,0x35,0x34,0x3c, 0xa6,0x7a,0xa3,0x26,
  0x9e,0x89,0xe9,0xa4, 0xcc,0x80,0x1a,0x8f, 0x53,0x46,0x9a,0x7a, 0x4d,0x33,0x40,0x69,
  0x31,0x90,0x4d,0x34, 0xc0,0x86,0x98,0x26, 0x98,0x8f,0x51,0x9a, 0x68,0xd2,0x60,0x9e,
  0xa6,0x69,0xa6,0x8d, 0x00,0xd0,0x98,0x00, 0x4c,0x21,0xa6,0x46, 0x83,0x46,0x98,0x64,
  0x69,0xa4,0xc0,0x86, 0x13,0x35,0x18,0x68, 0x98,0x9a,0x32,0x60, 0x39,0x14,0x7d,0xf1,
  0x00,0x00,0x04,0x03, 0x9a,0x43,0xf8,0x8b, 0x19,0x40,0x30,0x28, 0x8e,0x7a,0x13,0xc3,
  0x13,0x85,0x16,0x01, 0x47,0x42,0x2b,0xae, 0x68,0x65,0x79,0xc1, 0x86,0x5e,0x00,0xa8,
  0xde,0x35,0x58,0x26, 0xae,0x0e,0xcb,0xca, 0x3a,0x95,0xbb,0x49, 0x8f,0xe4,0xa6,0x6a,
  0xf0,0x62,0x30,0x69, 0x08,0x16,0x65,0x8d, 0xd7,0x9c,0xc4,0x16, 0x84,0xb8,0x81,0xc2,
  0x10,0x28,0x2e,0xd8, 0x10,0x20,0x07,0x3c, 0x81,0xd3,0x81,0x8d, 0x61,0xb5,0x57,0x18,
  0xb6,0x90,0x0b,0xa9, 0x08,0x37,0x09,0xe9, 0x7e,0xcc,0x77,0xae, 0xe2,0x96,0xa5,0xdf,
  0x26,0xe0,0x17,0xe0, 0xd1,0x21,0x98,0x0a, 0x10,0x7c,0xc7,0xc1, 0x01,0x69,0x41,0x79,
  0x90,0x78,0x4e,0xae, 0xb7,0xd4,0x0c,0x61, 0xb9,0xda,0xa8,0xbb, 0x38,0x14,0xc1,0xf9,
  0x9f,0xe4,0xe2,0xcd, 0x1f,0x8f,0x18,0x24, 0x56,0xc2,0x5f,0xf2, 0x44,0x24,0x5b,0x9f,
  0xe6,0x83,0x80,0xf9, 0xb2,0x82,0xdd,0xcf, 0x32,0xff,0x47,0x0a, 0x0e,0x98,0xd3,0x5a,
  0x0a,0x34,0x22,0x4c, 0xb5,0x0e,0xd4,0x25, 0xd7,0xac,0xfb,0xf8, 0xb0,0xbb,0x29,0x8c,
  0x0f,0xe4,0x10,0x6c, 0x01,0x61,0x9a,0x43, 0x65,0xdf,0x3e,0x8e, 0x21,0x09,0x5d,0xa6,
  0xfa,0x70,0x37,0x4d, 0x55,0x0a,0xff,0x5a, 0x04,0xc4,0x44,0x3c, 0x40,0x5c,0x9b,0x76,
  0x83,0x94,0xd1,0x49, 0xb6,0x13,0x44,0x2e, 0x09,0xc3,0x64,0xd6, 0x02,0x80,0x4a,0x48,
  0x74,0xa1,0xfd,0x83, 0x13,0x35,0xe0,0xb6, 0x73,0xb6,0xed,0xd7, 0x93,0xfd,0xf7,0x31,
  0x6b,0xc9,0x50,0x19, 0xe4,0xd8,0xd9,0xa7, 0xd2,0xf4,0x40,0x74, 0x05,0x25,0x07,0x95,
  0x0b,0x04,0x5f,0x32, 0x6a,0x0b,0x08,0x04, 0x3b,0x53,0x1e,0xf9, 0x1b,0x79,0x5d,0xa3,
  0xc8,0x22,0xf4,0xb5, 0x39,0x81,0x92,0xd4, 0x80,0xdc,0x61,0x86, 0x83,0x88,0x42,0x15,
  0x1e,0x96,0xf9,0x61, 0xa3,0xcf,0x58,0x40, 0x8d,0x1c,0x28,0xd0, 0x03,0xfd,0xe5,0x51,
  0x3d,0x99,0x9c,0xd8, 0x6e,0x53,0xd3,0x90, 0x50,0x37,0x33,0x5b, 0xd8,0xe8,0xfe,0x3a,
  0x77,0x52,0x56,0x3e, 0x79,0x06,0x2f,0x43, 0x80,0xa9,0x92,0x60, 0x42,0x11,0x84,0x10,
  0x0c,0x90,0x4a,0x3a, 0x5f,0x03,0xda,0x65, 0x1d,0xef,0x1c,0xaf, 0x73,0x93,0x59,0x2b,
  0x17,0x60,0x0b,0xa3, 0x2e,0x48,0x36,0xd0, 0x0a,0xf7,0xd5,0x3f, 0x54,0x25,0xcc,0xa9,
  0x1a,0x61,0xd6,0x27, 0x72,0x44,0x62,0x26, 0x40,0xca,0x50,0x06, 0x00,0x3b,0x85,0x64,
  0x13,0xaa,0x90,0x19, 0xc2,0xb4,0xd6,0x12, 0xcb,0xa0,0xcc,0x28, 0xab,0x76,0x0b,0xa2,
  0xc4,0x76,0x92,0x65, 0x1b,0x43,0x27,0xd0, 0xf2,0xf9,0x67,0xe0, 0xb5,0x5e,0x94,0x46,
  0x97,0x89,0x07,0x97, 0xdb,0x3d,0x80,0x1b, 0xbc,0x40,0xf0,0xdc, 0x7a,0x0d,0x04,0x9a,
  0x2b,0x70,0xfe,0x48, 0x38,0xc0,0x4b,0xa6, 0xca,0x11,0xff,0x88, 0xe0,0xab,0x1f,0x55,
  0xfc,0x29,0x72,0x10, 0x38,0x31,0x68,0x4b, 0x37,0x2b,0x42,0xd1, 0x8e,0x82,0x07,0x2d,
  0xcd,0xd5,0x92,0x32, 0x95,0xca,0x7a,0x05, 0xb9,0x73,0x4b,0x9e, 0x71,0xaf,0xa1,0xd9,
  0x60,0x27,0x46,0x04, 0x83,0x5f,0xb1,0x84, 0x70,0x6e,0xb2,0x48, 0xbd,0x3a,0x58,0xa2,
  0xd0,0xf9,0xbc,0x24, 0x43,0x4f,0x8e,0xe2, 0xeb,0x31,0xe5,0xe4, 0x2b,0xfc,0x2e,0x9c,
  0x0a,0x17,0x05,0x24, 0x59,0xd6,0x92,0xdb, 0x20,0x1b,0x5e,0x49, 0x58,0xc1,0x5e,0x29,
  0xb7,0xb7,0xd3,0xe7, 0xcf,0x64,0xa7,0xe4, 0x6a,0x15,0x03,0x2f, 0xeb,0x70,0x14,0x86,
  0x41,0xd7,0x1a,0xea, 0x9a,0x6a,0x37,0xb3, 0x9f,0x9a,0x8c,0xb1, 0xf7,0x67,0x9a,0x93,
  0xa4,0xc8,0x24,0x93, 0xfc,0xfd,0xb6,0x0e, 0x6e,0xbe,0xd6,0x25, 0x9b,0x20,0xf8,0x88,
  0x6d,0x8e,0x28,0xce, 0x88,0xf3,0x06,0x76, 0x69,0x0d,0x80,0x80, 0x87,0x2e,0xb2,0x23,
  0x5c,0x34,0xac,0x28, 0xe6,0xfd,0x82,0x7f, 0xa9,0xad,0x4d,0xa5, 0x44,0x7c,0xb9,0x7d,
  0xc7,0x5c,0xa4,0xc3, 0xd8,0xd2,0xe1,0xa7, 0xe1,0xa6,0x01,0x60, 0xf4,0x25,0x10,0x41,
  0x70,0x8b,0x26,0x4a, 0x7d,0x21,0x7c,0xfc, 0x04,0x37,0x7e,0xae, 0x07,0x1c,0xaa,0x91,
  0x8e,0xac,0x35,0x0f, 0xac,0xc1,0x7f,0x09, 0x43,0x7f,0xa5,0xa6, 0x8e,0x7e,0xd9,0xe2,
  0x65,0x50,0x31,0x92, 0x3a,0x37,0xc9,0x4b, 0xba,0xc4,0x3d,0x45, 0x90,0xb3,0x78,0x52,
  0x8e,0x64,0x72,0xa4, 0x06,0xbd,0x8a,0x47, 0x5c,0x93,0xe3,0x45, 0x62,0xa7,0xd8,0x73,
  0x7a,0xda,0x8d,0x9d, 0x85,0xcc,0x56,0xed, 0xb3,0xf8,0x85,0x3c, 0xb8,0x63,0x25,0xf2,
  0x22,0x02,0x18,0xeb, 0x09,0x41,0xac,0xc5, 0xe1,0x88,0x55,0x1f, 0xed,0xbd,0x5c,0x02,
  0x36,0x85,0x27,0xdf, 0xf5,0x76,0xf4,0x15, 0x86,0x2c,0x48,0xf0, 0xfb,0x20,0x3d,0x1f,
  0xe2,0x41,0x4a,0x41, 0x8e,0xc4,0xb4,0x38, 0x28,0x86,0xb8,0x04, 0x74,0x4f,0xee,0x45,
  0x42,0xb6,0x36,0x20, 0xf7,0xcc,0x53,0xf3, 0xfd,0x03,0x12,0x98, 0x11,0x48,0x87,0x12,
  0x16,0x57,0x3f,0x7c, 0x5d,0xc9,0x14,0xe1, 0x42,0x42,0x59,0xbb, 0x19,0xbc,          
  // 0x41e = 1054 data bytes (103%)
};

///////////////////////////////////////////////////////////////////////////////

static const u8 cert_ms00000002_bz2[] =
{
  // decompressed size: 0x240 = 576 bytes
  0x00,0x00,0x02,0x40,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0x0f,0x71, 0x9b,0x8a,0x00,0x00,
  0x06,0x7f,0xff,0xfe, 0xf7,0xbd,0xd9,0x25, 0x7f,0xfe,0xf5,0xbe, 0xeb,0xdb,0x6e,0xfe,
  0xed,0xef,0xdf,0x93, 0x97,0xf7,0x9c,0xbe, 0xbd,0xbe,0xfb,0xf9, 0x67,0x2f,0x32,0xee,
  0x9e,0xbe,0xe7,0xb0, 0x01,0x1b,0x30,0x20, 0x00,0x68,0x0d,0x34, 0xc8,0x19,0x1a,0x00,
  0x06,0x80,0x06,0x80, 0x0d,0x06,0x8d,0x03, 0x41,0xa6,0x80,0x06, 0x83,0x6a,0x18,0x8c,
  0x8d,0x03,0x46,0x26, 0x87,0xa8,0x0d,0x34, 0xd0,0x34,0x36,0xa6, 0x8f,0x44,0xc8,0xd3,
  0x62,0x13,0x6a,0x1d, 0x34,0x0d,0x03,0x4c, 0x20,0x0c,0x80,0xd1, 0x88,0x03,0x23,0x4d,
  0x03,0x4f,0x50,0x06, 0x83,0xca,0x69,0xa0, 0x00,0x18,0x27,0xa4, 0xc4,0x62,0x34,0x0d,
  0x1e,0xa6,0x9a,0x1e, 0xa1,0xa0,0xc8,0x69, 0x89,0xa0,0x01,0xa6, 0x9a,0x1a,0x03,0x40,
  0x55,0x46,0x9a,0x31, 0x34,0x32,0x68,0x69, 0xa0,0x1a,0x30,0x46, 0x98,0x83,0x41,0x90,
  0xd0,0x68,0x03,0x04, 0x0d,0x06,0x40,0x34, 0xd1,0x90,0x34,0x0c, 0x13,0x20,0x34,0x69,
  0xa6,0x99,0x00,0x68, 0x06,0x8d,0x18,0x9a, 0x32,0x0d,0x00,0x11, 0x24,0x47,0xe8,0x28,
  0x00,0x09,0xd8,0x82, 0x1e,0x41,0x40,0x09, 0x89,0x10,0x90,0x98, 0xbe,0x25,0x78,0xa0,
  0x84,0x05,0x84,0xb0, 0x69,0xba,0xa2,0xae, 0xb6,0xf9,0x88,0x5a, 0x61,0xfd,0xef,0xbe,
  0x28,0xe9,0x42,0xb5, 0x74,0x87,0x9b,0x4f, 0xac,0x00,0x27,0xcc, 0x69,0xe9,0x5d,0x7b,
  0x1b,0xbf,0xb9,0x9f, 0xc4,0xee,0x11,0x74, 0xdb,0x03,0xd5,0xeb, 0x0a,0xb8,0x67,0xd5,
  0xc5,0x87,0xa9,0xcf, 0x46,0xf0,0x1d,0x1b, 0xd6,0x9b,0xf4,0xd5, 0x03,0x1f,0xb1,0x43,
  0x06,0xd9,0x78,0xd8, 0x91,0xd6,0xf3,0x0f, 0x2e,0xb3,0x3e,0x60, 0xc3,0x1a,0x63,0xc8,
  0x21,0x58,0x12,0x11, 0x44,0x05,0xc3,0x44, 0x69,0xe8,0x85,0x02, 0xc8,0x1a,0xc6,0x41,
  0xe6,0xae,0xc6,0x7f, 0xab,0xdb,0x10,0x00, 0xac,0x59,0x8a,0x33, 0x5e,0xef,0xf1,0xd7,
  0xf7,0x1e,0x52,0x75, 0xab,0x89,0x6a,0x72, 0x21,0x67,0xaa,0xe1, 0x6a,0xcc,0xb1,0x6e,
  0x8b,0xa9,0xa0,0x8d, 0x38,0x10,0x75,0xa9, 0x46,0xe5,0xa7,0x60, 0x0a,0xe2,0x58,0xbf,
  0xbd,0x92,0x15,0x45, 0x1a,0xc1,0xba,0xbc, 0x30,0x81,0x90,0x67, 0xd0,0x9d,0xd3,0xee,
  0x37,0x1c,0xf0,0x13, 0xce,0x09,0xa9,0x9c, 0x58,0x9c,0x87,0x06, 0xcb,0x94,0x8d,0x88,
  0x80,0x02,0x39,0x22, 0x6a,0x17,0xf5,0x2d, 0x21,0xe0,0x95,0x70, 0x66,0x1a,0x84,0xe9,
  0x86,0x1c,0x52,0x4f, 0x80,0x0d,0x88,0x88, 0x22,0xd9,0xf2,0xde, 0x2c,0x73,0x1b,0xbb,
  0x14,0x00,0xbd,0x13, 0xd3,0x36,0x63,0xac, 0x4b,0xda,0xd4,0x35, 0x7a,0x58,0xd4,0x6e,
  0xb8,0x1e,0x34,0xbe, 0x7c,0xdd,0xb7,0x8c, 0x68,0xcd,0xcb,0x79, 0x75,0x4d,0x26,0x1a,
  0xa8,0x77,0x34,0x23, 0x71,0x86,0xb4,0x16, 0x02,0x67,0x6d,0x18, 0xce,0xce,0x89,0x0d,
  0x76,0xc0,0xba,0x6d, 0x72,0x9c,0x78,0x87, 0xa1,0xcf,0x91,0xe8, 0x64,0xbc,0x12,0xa0,
  0xa6,0x16,0x74,0xe2, 0xb3,0x22,0x67,0x08, 0x3a,0x07,0x2b,0x0d, 0x22,0x1c,0x7b,0x09,
  0x32,0xbe,0x65,0x89, 0xff,0x38,0xf9,0x1e, 0xbd,0x51,0x91,0xcd, 0x36,0xff,0x17,0x72,
  0x45,0x38,0x50,0x90, 0x0f,0x71,0x9b,0x8a,
  // 0x208 = 520 data bytes (91%)
};

///////////////////////////////////////////////////////////////////////////////

static const u8 cert_ms00000003_bz2[] =
{
  // decompressed size: 0x240 = 576 bytes
  0x00,0x00,0x02,0x40,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0xea,0x16, 0x57,0xc5,0x00,0x00,
  0x06,0x7f,0xff,0xff, 0xff,0x4f,0xb7,0xdd, 0xfe,0x5a,0xd3,0x7f, 0xbb,0xfd,0xfe,0xfb,
  0x77,0xf7,0xcb,0x7e, 0xdf,0x9a,0xbb,0x82, 0xfe,0xbe,0x1e,0xdf, 0xb1,0xf5,0x2e,0x55,
  0xb7,0xfb,0xff,0xb0, 0x01,0x1b,0x30,0x1d, 0x00,0x00,0xd0,0x68, 0x00,0x06,0x8d,0x03,
  0x40,0x34,0x34,0x68, 0xd1,0xa0,0x00,0x1a, 0x62,0x1a,0x1a,0x00, 0x0d,0x34,0x00,0x06,
  0x4d,0x0d,0x0f,0x51, 0xea,0x34,0xd0,0x60, 0x8d,0x0d,0x1a,0x32, 0x64,0xc6,0xa3,0x13,
  0x68,0x9e,0x9a,0x86, 0x51,0x93,0x46,0x86, 0x40,0x03,0x08,0x68, 0xd3,0x43,0x26,0x86,
  0x86,0x01,0x34,0x1a, 0x0c,0x86,0x80,0xc9, 0xa1,0xa0,0xd0,0x07, 0xa6,0x81,0x01,0x84,
  0x68,0x06,0x81,0xa3, 0x40,0x64,0x1a,0x03, 0x40,0xd0,0x00,0x68, 0x34,0x05,0x54,0xc8,
  0x0c,0x43,0x43,0x09, 0xa0,0x19,0x03,0x41, 0xa0,0x34,0x19,0x0d, 0x06,0x10,0x03,0x10,
  0x00,0x03,0x41,0x90, 0x34,0x0c,0x86,0x81, 0x90,0x69,0xa1,0xa6, 0x83,0x41,0xa0,0x68,
  0xc9,0x91,0x93,0x26, 0x10,0x30,0x84,0xb4, 0xba,0xaf,0x67,0xe0, 0x00,0x13,0x70,0x01,
  0x40,0x05,0x42,0x02, 0x81,0x72,0x69,0xc1, 0xa1,0x00,0xa7,0x8c, 0xa9,0x8f,0x9c,0xcb,
  0xab,0x19,0xf6,0x12, 0x6d,0x48,0x04,0xd2, 0x9d,0xe2,0xa2,0x47, 0xa3,0x6a,0x2a,0x53,
  0xab,0x0f,0xa1,0x6e, 0x1f,0xd8,0x74,0xc9, 0x68,0x0b,0x31,0x64, 0xf6,0xf2,0xb4,0xc2,
  0x41,0x3e,0x14,0x9f, 0x5d,0xd0,0xcc,0x71, 0x9b,0x69,0x9d,0x54, 0x51,0x4e,0x90,0x07,
  0x9d,0x38,0x13,0x54, 0xcc,0x41,0xe3,0x60, 0x3e,0x28,0x0a,0x99, 0x58,0x80,0xc6,0xb0,
  0x39,0xdf,0x80,0x07, 0xa6,0x45,0xab,0x8d, 0x60,0xd5,0xf9,0x49, 0x08,0x04,0x1e,0x2d,
  0xa5,0xf9,0x8b,0x7e, 0xf0,0x6a,0xed,0x24, 0xaf,0x99,0xb2,0xb3, 0xe5,0x77,0x88,0xd4,
  0x15,0x0e,0x4e,0x0e, 0xde,0xbd,0x88,0xba, 0x2c,0xc3,0x7e,0xcb, 0x88,0x29,0x97,0xa4,
  0xc0,0xca,0x49,0x6f, 0x16,0xd4,0xef,0xf2, 0xba,0x2f,0x97,0x81, 0x2e,0x95,0x27,0x68,
  0x0b,0x9f,0x28,0x03, 0x43,0x7a,0xd4,0x38, 0xf7,0x3c,0x7f,0x05, 0x28,0xc2,0xc9,0x14,
  0x2d,0x5c,0x40,0xd3, 0xd3,0x3f,0xa7,0x32, 0x95,0xd0,0x22,0x4d, 0xc4,0x9f,0xb5,0x6f,
  0x92,0x9b,0xa0,0x88, 0x2c,0x91,0xa9,0x4e, 0x8d,0x39,0x42,0x86, 0xc2,0x5a,0x71,0x81,
  0x8f,0x4c,0xe1,0x68, 0x25,0x94,0xac,0x26, 0xc5,0x2c,0x21,0x54, 0xb5,0xad,0x91,0x76,
  0xaf,0x1c,0xe0,0x95, 0x86,0x86,0x91,0xe6, 0x5a,0xf3,0xa4,0x8b, 0xb5,0x09,0xd0,0xf5,
  0xf9,0x1d,0x3e,0xcc, 0x06,0x32,0x23,0x0d, 0x7a,0xd2,0x56,0xef, 0x85,0x9b,0x38,0xc0,
  0x8c,0x2e,0x5c,0xd8, 0x13,0x20,0xfd,0xb0, 0x0d,0x11,0xf5,0x4d, 0xff,0x37,0x87,0x4c,
  0x98,0x38,0x13,0xcf, 0x29,0xe9,0x05,0x68, 0x58,0x96,0xa8,0x58, 0x01,0x09,0xe3,0x2a,
  0x1f,0x10,0xba,0x0c, 0x30,0x05,0x6d,0x54, 0x3f,0x68,0xdb,0x73, 0x5e,0x1e,0x22,0x08,
  0x18,0xe1,0x29,0x9c, 0xe6,0x76,0x3a,0xe0, 0x1a,0xfe,0x19,0x51, 0x50,0x20,0x14,0xbd,
  0xf1,0xd4,0x62,0xc6, 0xc8,0x8d,0x9c,0x5b, 0xc4,0x9b,0xbb,0xfc, 0x5d,0xc9,0x14,0xe1,
  0x42,0x43,0xa8,0x59, 0x5f,0x14,
  // 0x206 = 518 data bytes (91%)
};

///////////////////////////////////////////////////////////////////////////////

static const u8 cert_xs00000003_bz2[] =
{
  // decompressed size: 0x300 = 768 bytes
  0x00,0x00,0x03,0x00,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0xd7,0x26, 0xdd,0xae,0x00,0x00,
  0x07,0x7f,0xff,0xff, 0xf7,0xff,0xf3,0xbf, 0xbb,0xff,0xfb,0xff, 0x5f,0xfc,0xff,0xb1,
  0xef,0xf7,0xff,0x7e, 0xff,0xfd,0xff,0xfd, 0xff,0xff,0xfb,0xff, 0xff,0xef,0x9f,0xff,
  0xef,0xff,0xdd,0x30, 0x01,0x9a,0xb6,0x36, 0xd4,0x80,0x4f,0x46, 0x93,0x03,0x4d,0x1a,
  0x99,0x18,0x68,0x6a, 0x68,0x61,0x06,0x13, 0x68,0x11,0x80,0x08, 0xf5,0x0d,0x0c,0x35,
  0x3d,0x10,0xf5,0x0c, 0x68,0xd1,0x36,0xa7, 0xa9,0xe8,0x68,0x7a, 0x91,0x84,0xd1,0xe4,
  0x34,0x00,0x69,0x32, 0x1e,0xa7,0xa1,0xa4, 0xf2,0x68,0xc8,0xd1, 0x94,0xc4,0x7b,0x49,
  0xa8,0xda,0x9e,0x84, 0x63,0x4d,0x1a,0x7a, 0x24,0xda,0x9e,0x9a, 0x88,0x03,0x46,0x80,
  0x00,0x00,0x00,0x1a, 0x00,0xc8,0x00,0x00, 0x00,0x00,0x68,0x01, 0x88,0x68,0x34,0x68,
  0x01,0xa0,0x00,0xd1, 0xa0,0x00,0x1a,0x64, 0x01,0xa0,0x00,0x68, 0x00,0x00,0x01,0xa1,
  0xa0,0x03,0x46,0x9e, 0xa1,0x55,0x1e,0x48, 0x34,0x00,0x00,0x00, 0x00,0x34,0x06,0x80,
  0x06,0x40,0x00,0x00, 0x68,0x68,0x00,0xd0, 0x00,0x00,0x00,0x1a, 0x00,0x00,0x01,0xa0,
  0x1a,0x00,0x03,0x40, 0x00,0x00,0x00,0x01, 0xa0,0x01,0x6a,0x98, 0xae,0x81,0x00,0x00,
  0x04,0x4e,0x2a,0x84, 0x18,0x00,0xac,0x40, 0x22,0xc5,0x72,0xe0, 0xa5,0x02,0x01,0x46,
  0x42,0x7c,0x85,0x23, 0x2d,0xfa,0xf4,0xb7, 0x06,0x67,0xe0,0x1c, 0x78,0xad,0x8e,0xdc,
  0xad,0x52,0xbb,0x72, 0x1a,0x77,0xe3,0xf1, 0xb1,0x0e,0xea,0xaa, 0x54,0xd1,0x83,0xab,
  0x26,0x98,0x50,0x00, 0x6b,0xf5,0x6e,0xb3, 0x83,0x70,0x5f,0xdb, 0xb0,0xbf,0xbc,0x7b,
  0x46,0x11,0x2e,0x6e, 0x77,0xf9,0x79,0xb0, 0x42,0xd0,0x34,0x91, 0xc0,0x78,0xb2,0xa4,
  0x01,0xb6,0xcf,0xc4, 0x16,0x75,0xa4,0x0d, 0x00,0x2c,0x17,0x45, 0x2d,0x4c,0x45,0xdb,
  0x65,0xdc,0x48,0x6b, 0x17,0xcd,0xa5,0x47, 0x13,0x2e,0x36,0xc7, 0xca,0x32,0x70,0xb2,
  0xd4,0xcc,0xe3,0xb5, 0x73,0x8b,0x0e,0x5c, 0x7a,0xfe,0xda,0xf7, 0xef,0xb2,0x2c,0x48,
  0xb3,0x02,0x2f,0x2e, 0x68,0x22,0xe9,0x0c, 0xd4,0xfb,0x01,0xc6, 0x02,0x31,0x02,0x63,
  0xbd,0xe8,0xec,0x83, 0x18,0xcb,0x2c,0x9b, 0xfa,0x50,0xbb,0x7d, 0x82,0x48,0x8e,0xc7,
  0x3c,0x5e,0x20,0x45, 0x05,0x04,0x10,0x58, 0x3b,0x62,0x55,0x71, 0x50,0xf0,0xba,0xcb,
  0xa3,0x01,0x80,0x55, 0x0f,0x0c,0x06,0xb3, 0xd8,0xed,0xb4,0x9f, 0x4e,0x5a,0x98,0xea,
  0xcb,0x7f,0x39,0x12, 0x77,0x4e,0xfc,0x47, 0x25,0x13,0xf4,0x79, 0x40,0xc0,0xa0,0x47,
  0xa4,0x49,0x40,0xac, 0x22,0x4a,0x00,0x28, 0x1c,0x45,0xd9,0xe0, 0x4e,0x91,0x2e,0x37,
  0x31,0x08,0x8b,0x44, 0xe9,0xa3,0xce,0x70, 0x67,0x2a,0x31,0xcf, 0x93,0x66,0xfc,0x6b,
  0xb4,0xbd,0x87,0x80, 0x60,0x13,0xe1,0x8f, 0x97,0x6d,0x4d,0x66, 0x85,0x52,0xd2,0x85,
  0xc6,0xb7,0xa5,0x99, 0x5c,0x37,0xf3,0x50, 0x42,0xa9,0x3d,0x22, 0x07,0xd7,0xc4,0x61,
  0xcc,0x95,0xfc,0x6a, 0x73,0x87,0xd2,0x5b, 0x7a,0x4b,0x79,0x17, 0x9e,0xe4,0x32,0x14,
  0xbb,0x92,0x19,0x01, 0x3c,0x25,0x6d,0x48, 0x89,0x2d,0x28,0x12, 0x90,0x96,0x29,0x12,
  0x21,0x6c,0xee,0xf7, 0x50,0x30,0x30,0x6c, 0x71,0xef,0x99,0x42, 0xa8,0x03,0xd7,0x24,
  0x36,0xe5,0x57,0x97, 0xc3,0xcf,0x02,0xd8, 0x2e,0xd1,0x64,0x85, 0x3b,0x06,0xe2,0x48,
  0x9f,0x33,0x18,0x8f, 0x0f,0x49,0x72,0xbb, 0x3a,0x1e,0xe8,0x7d, 0xc4,0x27,0x7b,0xeb,
  0x71,0x0d,0xaf,0x53, 0x1a,0x1b,0x60,0xc4, 0xe4,0x8c,0xfc,0x45, 0x1f,0x90,0x26,0xef,
  0x57,0xd2,0x09,0x1f, 0x5f,0xc0,0x79,0x1e, 0x87,0xf4,0xb4,0x38, 0x6d,0x95,0x41,0xf2,
  0xd4,0x3a,0x5f,0x69, 0xdb,0x03,0x7a,0xb6, 0xbf,0x0c,0x02,0xe0, 0xfd,0x23,0x5e,0x30,
  0x99,0x37,0x05,0x88, 0xda,0xde,0xd2,0x5f, 0x3f,0x24,0x87,0x35, 0xcb,0xd3,0xba,0xa8,
  0x89,0xca,0x6b,0x09, 0xe4,0x40,0xce,0x3f, 0xa9,0x19,0x82,0x07, 0x18,0xb1,0x3f,0x94,
  0x01,0x41,0xe3,0xb8, 0xb6,0x18,0xb3,0x8c, 0xbd,0xd5,0x32,0xcb, 0x7d,0xe0,0xd8,0x97,
  0xfd,0x77,0x5d,0x5a, 0x82,0xd5,0xe9,0xd9, 0x04,0x6c,0x5b,0xc1, 0xda,0xd5,0x72,0x28,
  0x4c,0xc7,0x86,0x5e, 0x2e,0xe3,0x02,0x80, 0x25,0xe8,0xb5,0xc0, 0xb3,0x22,0x9d,0xe4,
  0x37,0x46,0x97,0x7c, 0xfb,0x09,0x59,0x7a, 0xdd,0x32,0x55,0xc5, 0x8b,0xe8,0x68,0xd0,
  0x18,0x79,0x88,0x14, 0x0c,0x14,0x1d,0xd6, 0x08,0x9b,0xfc,0xdc, 0x2b,0x66,0xe6,0x68,
  0x86,0x4d,0x53,0xdf, 0xff,0xc5,0xdc,0x91, 0x4e,0x14,0x24,0x35, 0xc9,0xb7,0x6b,0x80,
  // 0x2e0 = 736 data bytes (96%)
};

///////////////////////////////////////////////////////////////////////////////

static const u8 cert_cp00000004_bz2[] =
{
  // decompressed size: 0x300 = 768 bytes
  0x00,0x00,0x03,0x00,

  // bzipped data
  0x42,0x5a,0x68,0x39, 0x31,0x41,0x59,0x26, 0x53,0x59,0x84,0xd8, 0x73,0x35,0x00,0x00,
  0x07,0x7f,0xff,0xff, 0xf6,0xf4,0xff,0xfd, 0xb7,0xfd,0xf3,0xff, 0xdf,0xff,0xff,0xfd,
  0xdf,0xfe,0xff,0x7f, 0xdf,0xfd,0xff,0xfd, 0xff,0xbd,0xff,0xbe, 0xff,0xff,0xef,0xfb,
  0xf6,0xfd,0xd5,0x30, 0x01,0x9a,0xb3,0x28, 0x92,0x69,0xe2,0x4d, 0xa2,0x69,0xa7,0xa0,
  0x4c,0x99,0x34,0xf2, 0x23,0x3d,0x53,0x13, 0x26,0x4d,0x91,0x36, 0x82,0x6d,0x47,0xa3,
  0x53,0x46,0x18,0xa6, 0xd0,0x4d,0x31,0xa8, 0xda,0x86,0x02,0x3d, 0x4c,0x13,0xd2,0x3d,
  0x00,0xca,0x7a,0x9e, 0xa3,0x6a,0x7a,0x86, 0x43,0x08,0xf2,0x83, 0x0c,0x26,0x98,0xa7,
  0xa8,0xf5,0x36,0xa6, 0xd0,0xc4,0x34,0x34, 0x26,0x35,0x3c,0x9b, 0x51,0xe9,0x08,0x00,
  0x00,0x32,0x34,0xd0, 0x00,0x01,0xa0,0x01, 0x91,0xa0,0x00,0xd0, 0xd0,0x06,0x80,0x68,
  0x00,0x01,0xa1,0xa0, 0xd0,0xd0,0xd0,0x34, 0x03,0x40,0x00,0x00, 0x00,0x34,0xd3,0x40,
  0x01,0xa0,0x03,0x20, 0x1a,0x68,0xd0,0x64, 0x0a,0xa9,0xb1,0x40, 0xc8,0x00,0x00,0x00,
  0x03,0xd2,0x68,0x00, 0x00,0x34,0x00,0x03, 0x40,0x03,0x40,0x00, 0x00,0xd0,0x00,0x06,
  0x80,0x00,0x00,0x00, 0x00,0x00,0x68,0x00, 0x00,0x00,0x00,0x00, 0x31,0x44,0x58,0x91,
  0x00,0x00,0x08,0x54, 0x50,0x83,0x00,0x08, 0xd0,0xe4,0x86,0x5c, 0x5e,0x33,0x9c,0xa8,
  0x60,0x2d,0x21,0x0a, 0xa8,0x4b,0x12,0x5a, 0x7f,0x0f,0x3a,0xe0, 0x89,0x22,0xd0,0x77,
  0xaa,0xb7,0x91,0x72, 0x38,0x23,0x42,0xcd, 0x2e,0xc7,0x48,0xcb, 0x5e,0x9d,0x60,0x7c,
  0x5d,0x83,0x93,0xaf, 0x43,0x14,0x5e,0x1e, 0x2b,0xc9,0xe4,0x47, 0x14,0x4c,0x01,0x54,
  0x6b,0x05,0x80,0xc6, 0xe3,0x8c,0xe0,0x05, 0xc1,0xc5,0x2d,0xa5, 0xf0,0xdd,0x69,0xf8,
  0x02,0x3e,0x5d,0xa3, 0xa6,0x63,0xab,0xd2, 0x29,0x3d,0xce,0x26, 0x60,0x26,0x02,0xb4,
  0x60,0x00,0x6c,0xba, 0xde,0x7c,0x3c,0xa1, 0xd3,0x10,0xd2,0x7e, 0xc5,0x2d,0x47,0x0e,
  0x88,0x6b,0xd4,0x1f, 0x0e,0x17,0x27,0x08, 0x86,0xaa,0x13,0x4d, 0xa4,0x03,0xe6,0x65,
  0x5c,0x17,0x23,0x30, 0x87,0x78,0xc0,0x1f, 0x38,0x74,0xb3,0x15, 0x63,0x9c,0xa3,0xb8,
  0x20,0x0a,0x87,0xef, 0xe9,0x37,0x16,0x48, 0xea,0x61,0x12,0x64, 0xe1,0x85,0x23,0xe8,
  0x58,0x81,0x31,0xce, 0x0e,0xa5,0x8c,0xe5, 0x92,0x82,0x71,0x48, 0xbc,0x91,0x53,0x01,
  0x6e,0x42,0xda,0x69, 0x00,0x36,0x64,0xb2, 0x8e,0xa7,0xb4,0x50, 0x24,0x7b,0xed,0xf1,
  0x53,0x52,0x4a,0xab, 0x65,0x9e,0x06,0xac, 0x92,0x69,0x16,0x66, 0xbb,0x12,0x50,0x48,
  0x78,0x4b,0xc1,0x27, 0xc0,0x90,0x75,0xc2, 0x72,0xed,0x04,0xbb, 0x18,0x56,0xc0,0xbc,
  0x0a,0x57,0x8c,0x04, 0xc1,0x9c,0x54,0x3f, 0x85,0x68,0xa1,0xa5, 0x90,0x25,0x2d,0xa8,
  0x23,0x8a,0xb9,0x72, 0xea,0x35,0xf8,0x2a, 0xfa,0x2e,0x0d,0x65, 0x65,0xb2,0x92,0x35,
  0x99,0xde,0x53,0x9e, 0xd2,0x08,0x78,0xaf, 0x18,0x8b,0xcd,0xbc, 0x62,0x45,0x3c,0x9b,
  0xdf,0xdb,0x82,0x50, 0xc1,0x95,0xa1,0x75, 0x4e,0x6e,0x5f,0xa8, 0x0a,0x9d,0x87,0xd8,
  0x37,0xe9,0x0b,0x1f, 0x50,0x84,0xea,0x12, 0x39,0x04,0xb6,0xbf, 0xfd,0x6d,0x07,0xf0,
  0xff,0x6f,0xab,0xeb, 0x78,0x12,0xc0,0x7e, 0x87,0xe8,0xdb,0xbb, 0x2a,0xb6,0x68,0xe2,
  0xed,0xb6,0x86,0x8f, 0x0d,0xa2,0x20,0x31, 0x49,0x75,0xc1,0x0d, 0xc0,0x48,0x8d,0x1e,
  0x5e,0x30,0x59,0x42, 0x10,0x43,0x7e,0xfa, 0x07,0x8e,0xb7,0xfa, 0x5e,0x8a,0x25,0xe4,
  0xc8,0x6a,0x76,0xf4, 0x4f,0xba,0x16,0xeb, 0xb9,0xd2,0x0f,0xcd, 0xa6,0x0d,0x03,0xca,
  0x9e,0xea,0xb3,0x64, 0xf7,0xb2,0x77,0xcb, 0xa3,0xae,0xdb,0x8e, 0xc8,0x5a,0xab,0xa2,
  0x25,0xe5,0x75,0x81, 0x39,0xcc,0xe9,0x37, 0xf9,0x93,0x7f,0xf4, 0x0c,0xb0,0xdd,0x7d,
  0x62,0x90,0xd7,0x7e, 0x7b,0xe1,0x97,0x1b, 0xa3,0xac,0xcc,0xb1, 0x2c,0x4c,0x05,0x05,
  0x42,0x95,0xb3,0x40, 0x03,0xa7,0xf9,0xf9, 0x38,0x4d,0x58,0x36, 0x0b,0x88,0xe5,0xc1,
  0x81,0x86,0xf9,0x59, 0xb1,0x09,0xa3,0xbf, 0x3c,0xea,0x82,0x38, 0xd1,0x26,0x2d,0xd5,
  0x47,0x9d,0x0c,0x88, 0x3d,0x28,0x25,0x4c, 0xb7,0x12,0x79,0x7f, 0xbb,0xdb,0xdc,0xdc,
  0x96,0xb1,0xa6,0xee, 0x8d,0xd2,0x6b,0xb8, 0xe1,0x22,0xdc,0x32, 0x7f,0x59,0xd4,0xcf,
  0x3c,0xd7,0xa4,0xab, 0xf7,0xc7,0xc8,0x87, 0x85,0x20,0x40,0x7e, 0xed,0x72,0xc4,0x76,
  0x55,0x82,0xab,0x5a, 0x4b,0xe0,0x8e,0x54, 0x10,0xee,0x58,0x5f, 0x67,0x2a,0xb2,0xbb,
  0x22,0x0b,0x27,0x85, 0xfe,0x83,0x38,0x9a, 0xeb,0xfe,0x2e,0xe4, 0x8a,0x70,0xa1,0x21,
  0x09,0xb0,0xe6,0x6a,
  // 0x2e4 = 740 data bytes (97%)
};

///////////////////////////////////////////////////////////////////////////////

void setup_cert_data()
{
    static bool done = false;
    if (!done)
    {
	done = true;

	int i;
	for ( i = 0; i < sizeof(std_cert_chain); i++ )
	    std_cert_chain[i] ^= 0xdc;

	const int key_size = cert_get_pubkey_size(ntohl(root_cert.key_type));
	for ( i = 0; i < key_size; i++ )
	    root_cert.public_key[i] ^= 0xdc;
    }
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			bn helpers			///////////////
///////////////////////////////////////////////////////////////////////////////

#define bn_zero(a,b)      memset(a,0,b)
#define bn_copy(a,b,c)    memcpy(a,b,c)
#define bn_compare(a,b,c) memcmp(a,b,c)

///////////////////////////////////////////////////////////////////////////////
// calc a = a mod N, given n = size of a,N in bytes

static void bn_sub_modulus ( u8 *a, const u8 *N, const u32 n )
{
    uint i;
    u8 c = 0;

    for ( i = n - 1; i < n; i-- )
    {
	const u32 dig = N[i] + c;
	c = a[i] < dig;
	a[i] -= dig;
    }
}

///////////////////////////////////////////////////////////////////////////////
// calc d = (a + b) mod N, given n = size of d,a,b,N in bytes

static void bn_add ( u8 *d, const u8 *a, const u8 *b, const u8 *N, const u32 n )
{
    uint i;
    u8 c = 0;

    for (i = n - 1; i < n; i--)
    {
	const u32 dig = a[i] + b[i] + c;
	c = (dig >= 0x100);
	d[i] = dig;
    }

    if (c)
	bn_sub_modulus(d, N, n);

    if ( bn_compare(d, N, n) >= 0 )
	bn_sub_modulus(d, N, n);
}

///////////////////////////////////////////////////////////////////////////////
// calc d = (a * b) mod N, given n = size of d,a,b,N in bytes

static void bn_mul ( u8 *d, const u8 *a, const u8 *b, const u8 *N, const u32 n )
{
    bn_zero(d,n);

    uint i;
    u8 mask;
    for ( i = 0; i < n; i++ )
	for ( mask = 0x80; mask != 0; mask >>= 1 )
	{
	    bn_add(d, d, d, N, n);
	    if ((a[i] & mask) != 0)
		bn_add(d, d, b, N, n);
	}
}

///////////////////////////////////////////////////////////////////////////////
// calc d = (a ^ e) mod N, given n = size of d,a,N and en = size of e in bytes

static void bn_exp(u8 *d, const u8 *a, const u8 *N, const u32 n, const u8 *e, const u32 en)
{
    u8 t[512];
    u32 i;
    u8 mask;

    bn_zero(d, n);
    d[n-1] = 1;
    for ( i = 0; i < en; i++ )
	for ( mask = 0x80; mask != 0; mask >>= 1 )
	{
	    bn_mul(t, d, d, N, n);
	    if ((e[i] & mask) != 0)
		bn_mul(d, t, a, N, n);
	    else
		bn_copy(d, t, n);
	}
}

///////////////////////////////////////////////////////////////////////////////

void bn_inv ( u8 *d, const u8 *a, const u8 *N, const u32 n )
{
    u8 t[512], s[512];

    bn_copy(t, N, n);
    bn_zero(s, n);
    s[n-1] = 2;
    bn_sub_modulus(t, s, n);
    bn_exp(d, a, N, n, t, n);
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			elt helpers			///////////////
///////////////////////////////////////////////////////////////////////////////

#define elt_zero(d)	memset(d,0,30)
#define elt_copy(d,s)	memcpy(d,s,30)

///////////////////////////////////////////////////////////////////////////////

static int elt_is_zero ( const u8 *d )
{
    uint i;
    for ( i = 0; i < 30; i++ )
	if (d[i] != 0)
	    return 0;
    return 1;
}

///////////////////////////////////////////////////////////////////////////////

static void elt_add ( u8 *d, const u8 *a, const u8 *b )
{
    uint i;
    for ( i = 0; i < 30; i++ )
	d[i] = a[i] ^ b[i];
}

///////////////////////////////////////////////////////////////////////////////

static void elt_mul_x ( u8 *d, const u8 *a )
{
    u8 carry = a[0] & 1;
    u8 x = 0, y;

    uint i;
    for ( i = 0; i < 29; i++ )
    {
	y = a[i+1];
	d[i] = x ^ y>>7;
	x = (u8)(y<<1);
    }
    d[29] = x ^ carry;
    d[20] ^= carry << 2;
}

///////////////////////////////////////////////////////////////////////////////

static void elt_mul ( u8 *d, const u8 *a, const u8 *b )
{
    elt_zero(d);
    u8 mask = 1;
    uint i = 0, n;

    for ( n = 0; n < 233; n++ )
    {
	elt_mul_x(d,d);

	if ( a[i] & mask )
	    elt_add(d,d,b);

	mask >>= 1;
	if ( !mask)
	{
	    mask = 0x80;
	    i++;
	}
    }
}

///////////////////////////////////////////////////////////////////////////////

static void elt_square_to_wide ( u8 *d, const u8 *a )
{
    static const u8 square[16] =
	"\x00\x01\x04\x05\x10\x11\x14\x15\x40\x41\x44\x45\x50\x51\x54\x55";

    uint i;
    for ( i = 0; i < 30; i++ )
    {
	d[ 2*i   ] = square[ a[i] >> 4 ];
	d[ 2*i+1 ] = square[ a[i] & 15 ];
    }
}

///////////////////////////////////////////////////////////////////////////////

static void wide_reduce ( u8 *d )
{
    uint i;
    for ( i = 0; i < 30; i++ )
    {
	u8 x = d[i];
	d[i + 19] ^= x >> 7;
	d[i + 20] ^= x << 1;
	d[i + 29] ^= x >> 1;
	d[i + 30] ^= x << 7;
    }

    u8 x = d[30] & ~1;

    d[49] ^= x >> 7;
    d[50] ^= x << 1;
    d[59] ^= x >> 1;
    d[30] &= 1;
}

///////////////////////////////////////////////////////////////////////////////

static void elt_square ( u8 *d, const u8 *a )
{
    u8 wide[60];

    elt_square_to_wide(wide, a);
    wide_reduce(wide);

    elt_copy(d, wide + 30);
}

///////////////////////////////////////////////////////////////////////////////

static void itoh_tsujii ( u8 *d, const u8 *a, const u8 *b, uint j )
{
    u8 t[30];
    elt_copy(t,a);

    while (j--)
    {
	elt_square(d,t);
	elt_copy(t,d);
    }
    elt_mul(d,t,b);
}

///////////////////////////////////////////////////////////////////////////////

static void elt_inv ( u8 *d, const u8 *a )
{
    u8 t[30];
    u8 s[30];

    itoh_tsujii( t, a, a,   1);
    itoh_tsujii( s, t, a,   1);
    itoh_tsujii( t, s, s,   3);
    itoh_tsujii( s, t, a,   1);
    itoh_tsujii( t, s, s,   7);
    itoh_tsujii( s, t, t,  14);
    itoh_tsujii( t, s, a,   1);
    itoh_tsujii( s, t, t,  29);
    itoh_tsujii( t, s, s,  58);
    itoh_tsujii( s, t, t, 116);
    elt_square(d,s);
}

///////////////////////////////////////////////////////////////////////////////

static int point_is_zero ( const u8 *p )
{
    return elt_is_zero(p) && elt_is_zero(p+30);
}

///////////////////////////////////////////////////////////////////////////////

static void point_double ( u8 *r, const u8 *p )
{
    u8 s[30], t[30];
    const u8 *px = p;
    const u8 *py = p + 30;
    u8 *rx = r;
    u8 *ry = r + 30;

    if (elt_is_zero(px))
    {
	elt_zero(rx);
	elt_zero(ry);
	return;
    }

    elt_inv(t,px);	// t = 1/px
    elt_mul(s,py,t);	// s = py/px
    elt_add(s,s,px);	// s = py/px + px

    elt_square(t,px);	// t = px*px

    elt_square(rx,s);	// rx = s*s
    elt_add(rx,rx,s);	// rx = s*s + s
    rx[29] ^= 1;	// rx = s*s + s + 1

    elt_mul(ry,s,rx);	// ry = s * rx
    elt_add(ry,ry,rx);	// ry = s*rx + rx
    elt_add(ry,ry,t);	// ry = s*rx + rx + px*px
}

///////////////////////////////////////////////////////////////////////////////

static void point_add ( u8 *r, const u8 *p, const u8 *q )
{
    u8 s[30], t[30], u[30];

    const u8 *px = p;
    const u8 *py = p + 30;
    const u8 *qx = q;
    const u8 *qy = q + 30;
    u8 *rx = r;
    u8 *ry = r + 30;

    if (point_is_zero(p))
    {
	elt_copy(rx,qx);
	elt_copy(ry,qy);
	return;
    }

    if (point_is_zero(q))
    {
	elt_copy(rx,px);
	elt_copy(ry,py);
	return;
    }

    elt_add(u,px,qx);

    if (elt_is_zero(u))
    {
	elt_add(u, py, qy);
	if (elt_is_zero(u))
	    point_double(r, p);
	else
	{
	    elt_zero(rx);
	    elt_zero(ry);
	}
	return;
    }

    elt_inv(t, u);
    elt_add(u, py, qy);
    elt_mul(s, t, u);

    elt_square(t, s);
    elt_add(t, t, s);
    elt_add(t, t, qx);
    t[29] ^= 1;

    elt_mul(u, s, t);
    elt_add(s, u, py);
    elt_add(rx, t, px);
    elt_add(ry, s, rx);
}

///////////////////////////////////////////////////////////////////////////////

static void point_mul ( u8 *d, const u8 *a, const u8 *b ) // a is bignum
{
    elt_zero(d);
    elt_zero(d+30);

    uint i;
    u8 mask;
    for ( i = 0; i < 30; i++ )
	for ( mask = 0x80; mask; mask >>= 1 )
	{
	    point_double(d, d);
	    if ( a[i] & mask )
		point_add(d, d, b);
	}
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			cert helpers			///////////////
///////////////////////////////////////////////////////////////////////////////

ccp cert_get_status_message
(
    cert_stat_t		stat,		// status
    ccp			ret_invalid	// return value if 'stat' unknown
)
{
    switch (stat)
    {
	case CERT_SIG_OK:		return "Signature ok";
	case CERT_SIG_FAKE_SIGNED:	return "Signature ok but fake signed";
	case CERT_HASH_FAILED:		return "Signature ok but hash failed";

	case CERT_HASH_OK:		return "Signature wrong but hash is ok";
	case CERT_FAKE_SIGNED:		return "Signature wrong but fake signed";
	case CERT_SIG_FAILED:		return "Signature wrong";

	case CERT_ERR_TYPE_MISSMATCH:	return "Different types of signature and key";
	case CERT_ERR_NOT_SUPPORTED:	return "This kind of signature is not supported";
	case CERT_ERR_NOT_FOUND:	return "Certificate not found";
	case CERT_ERR_INVALID_SIG:	return "Signature is invalid";
    }

    return ret_invalid;
};

///////////////////////////////////////////////////////////////////////////////

ccp cert_get_status_name
(
    cert_stat_t		stat,		// status
    ccp			ret_invalid	// return value if 'stat' unknown
)
{
    switch (stat)
    {
	case CERT_SIG_OK:		return "OK";
	case CERT_SIG_FAKE_SIGNED:	return "SIG FAKE SIGNED";
	case CERT_HASH_FAILED:		return "HASH FAILED";

	case CERT_HASH_OK:		return "HASH OK";
	case CERT_FAKE_SIGNED:		return "FAKE SIGNED";
	case CERT_SIG_FAILED:		return "SIG FAILED";

	case CERT_ERR_TYPE_MISSMATCH:	return "CERT TYPE MISMATCH";
	case CERT_ERR_NOT_SUPPORTED:	return "CERT TYPE NOT SUPPORTED";
	case CERT_ERR_NOT_FOUND:	return "CERT NOT FOUND";
	case CERT_ERR_INVALID_SIG:	return "SIG INVALID";
    }

    return ret_invalid;
};

///////////////////////////////////////////////////////////////////////////////

const sig_info_t * cert_get_signature_info ( uint sig_type )
{
    static const sig_info_t rsa_4096 = { 0x10000, 0x200, 0x200, 0x200, "RSA-4096" };
    static const sig_info_t rsa_2068 = { 0x10001, 0x100, 0x100, 0x100, "RSA-2048" };
    static const sig_info_t e_curve  = { 0x10002, 0x040, 0x03c, 0x03c, "Elliptic Curve" };

    switch (sig_type)
    {
	case 0x10000:	return &rsa_4096;
	case 0x10001:	return &rsa_2068;
	case 0x10002:	return &e_curve;
    }
    return 0;
}

//-----------------------------------------------------------------------------

ccp cert_get_signature_name
(
    u32			sig_type,	// signature type
    ccp			ret_invalid	// return value if 'sig_type' unknown
)
{
    const sig_info_t *si = cert_get_signature_info(sig_type);
    return si ? si->name : ret_invalid;
}

//-----------------------------------------------------------------------------

int cert_get_signature_space ( u32 sig_type )
{
    const sig_info_t *si = cert_get_signature_info(sig_type);
    return si ? si->sig_space : 0;
}

int cert_get_signature_size ( u32 sig_type )
{
    const sig_info_t *si = cert_get_signature_info(sig_type);
    return si ? si->sig_size : 0;
}

int cert_get_pubkey_size ( u32 key_type )
{
    const sig_info_t *si = cert_get_signature_info(key_type|0x10000);
    return si ? si->key_size : 0;
}

int cert_get_data_size ( u32 key_type )
{
    int data_size = cert_get_pubkey_size(key_type);
    if ( data_size > 0 )
    {
	data_size = ALIGN32(data_size,WII_CERT_ALIGN )
		  + ALIGN32(sizeof(cert_data_t),WII_CERT_ALIGN);
    }
    return data_size;
}

///////////////////////////////////////////////////////////////////////////////

cert_data_t * cert_get_data // return NULL if invalid
(
    const void		* head		// NULL or pointer to cert header (cert_head_t)
)
{
    if (head)
    {
	const sig_info_t *si = cert_get_signature_info(be32(head));
	if (si)
	{
	    const u32 head_size
		= ALIGN32( si->sig_space + sizeof(cert_head_t), WII_CERT_ALIGN );
	    return (cert_data_t*)( (u8*)head + head_size );
	}
    }
    return 0;
}

///////////////////////////////////////////////////////////////////////////////

cert_head_t * cert_get_next_head // return NULL if invalid
(
    const void		* data		// NULL or pointer to cert data (cert_data_t)
)
{
    if (data)
    {
	const cert_data_t *cdata = data;
	const int data_size = cert_get_data_size(ntohl(cdata->key_type));
	if (data_size)
	    return (cert_head_t*)( (u8*)data + data_size );
    }
    return 0;
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			root cert			///////////////
///////////////////////////////////////////////////////////////////////////////

cert_item_t * cert_append_item
(
    cert_chain_t	* cc,		// valid pointer to cert chain
    ccp			issuer,		// NULL or pointer to issuer
    ccp			key_id,		// valid pointer to key id
    bool		uniq		// true: avoid duplicates
)
{
    DASSERT(cc);
    DASSERT( key_id && key_id );

    cert_item_t * item;
    char name[sizeof(item->name)];
    if ( issuer && *issuer )
	snprintf(name,sizeof(name),"%s-%s",issuer,key_id);
    else
	snprintf(name,sizeof(name),"%s",key_id);

    if (uniq)
    {
	// search for item with identical name

	int i;
	for ( i = 0; i < cc->used; i++ )
	{
	    item = cc->cert + i;
	    if (!strcmp(name,item->name))
	    {
		FREE((void*)item->head);
		goto found;
	    }
	}
    }

    if ( cc->used == cc->size )
    {
	cc->size = 2 * cc->size + 5;
	cc->cert = REALLOC(cc->cert,cc->size*sizeof(*cc->cert));
    }

    item = cc->cert + cc->used++;

 found:
    memset(item,0,sizeof(*item));
    memcpy(item->name,name,sizeof(item->name));
    return item;
}

///////////////////////////////////////////////////////////////////////////////

void cert_add_root ( ccp issuer )
{
    if ( issuer && strcmp(issuer,"Root") )
	return;

    static bool done = false;
    if (!done)
    {
	done = true;
	setup_cert_data();

	cert_item_t * item = cert_append_item(&global_cert,0,"Root",true);
	DASSERT(item);
	item->data	= &root_cert;
	item->key_size	= cert_get_pubkey_size(ntohl(root_cert.key_type));
	item->data_size	= sizeof(root_cert);
	item->cert_size	= sizeof(root_cert) + item->key_size;
    }
}

///////////////////////////////////////////////////////////////////////////////

static BZ2Manager_t cert_mgr[] =
{
	{ cert_ca00000001_bz2, sizeof(cert_ca00000001_bz2), 0, 0 },
	{ cert_ms00000002_bz2, sizeof(cert_ms00000002_bz2), 0, 0 },
	{ cert_xs00000003_bz2, sizeof(cert_xs00000003_bz2), 0, 0 },
	{ cert_cp00000004_bz2, sizeof(cert_cp00000004_bz2), 0, 0 },

	{ cert_ca00000002_bz2, sizeof(cert_ca00000002_bz2), 0, 0 },
	{ cert_ms00000003_bz2, sizeof(cert_ms00000003_bz2), 0, 0 },

	{0,0,0,0}
};

//-----------------------------------------------------------------------------

void cert_add_auto()
{
    static bool done = false;
    if (done)
	return;
    done = true;

    BZ2Manager_t *ptr;
    for ( ptr = cert_mgr; ptr->src_data; ptr++ )
    {
	DecodeBZIP2Manager(ptr);
	PRINT0("DecodeBZIP2Manager() data=%p, size=%u\n",ptr->data,ptr->size);
	cert_append_data(&auto_cert,ptr->data,ptr->size,false);
    }
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			certificate chain		///////////////
///////////////////////////////////////////////////////////////////////////////

cert_chain_t global_cert = {0};
cert_chain_t auto_cert = {0};

///////////////////////////////////////////////////////////////////////////////

cert_chain_t * cert_initialize
(
    cert_chain_t	* cc		// NULL or pointer to structure
					// if NULL: alloc data
)
{
    if (!cc)
	cc = MALLOC(sizeof(*cc));
    memset(cc,0,sizeof(*cc));
    return cc;
}

///////////////////////////////////////////////////////////////////////////////

static const cert_item_t * FindCertItemHelper
(
    ccp			issuer,	// name to search
    const cert_chain_t	*cc	// search this
)
{
    if (cc)
    {
	int c;
	for ( c = 0; c < cc->used; c++ )
	{
	    cert_item_t *item = cc->cert + c;
	    if (!strcmp(issuer,item->name))
		return item;
	}
    }

    return 0;
}

//-----------------------------------------------------------------------------

const cert_item_t * FindCertItem
(
    ccp		issuer,		// name to search
    const cert_chain_t
		*cc,		// not NULL: search here first
    bool	search_global,	// if not found: search 'global_cert'
    bool	auto_auto	// if not found: search 'auto_cert' and add cert's
)
{
    const cert_item_t *it = FindCertItemHelper(issuer,cc);
    PRINT_IF(it,"CERT '%s' found in cc\n",issuer);

    if ( !it && search_global )
    {
	cert_add_root(issuer);

	it = FindCertItemHelper(issuer,&global_cert);
	PRINT_IF(it,"CERT '%s' found in global\n",issuer);
    }

    if ( !it && auto_auto )
    {
	cert_add_auto();
	it = FindCertItemHelper(issuer,&auto_cert);
	PRINT_IF(it,"CERT '%s' found in auto\n",issuer);
    }

    return it;
}

///////////////////////////////////////////////////////////////////////////////

void cert_reset
(
    cert_chain_t	* cc		// valid pointer to cert chain
)
{
    DASSERT(cc);
    int i;
    for ( i = 0; i < cc->used; i++ )
	FREE((void*)cc->cert[i].head);
    FREE(cc->cert);
    cert_initialize(cc);
}

///////////////////////////////////////////////////////////////////////////////

int cert_append_data
(
    cert_chain_t	* cc,		// valid pointer to cert chain
    const void		* data,		// NULL or pointer to cert data
    size_t		data_size,	// size of 'data'
    bool		uniq		// true: avoid duplicates
)
{
    DASSERT(cc);
    TRACE("cert_append_data(%p,%p,%zu,%d) n=%u/%u\n",
		cc, data, data_size, uniq, cc->used, cc->size );

    const int start_count = cc->used;
    if ( data && data_size > 0 )
    {
	//--- analyze cert data

	const u8 * ptr = data;
	const u8 * end = ptr + data_size;
	while ( ptr < end )
	{
	    // [[2do]]
	    const u8 * start = ptr;
	    const cert_head_t * head = (cert_head_t*)ptr;
	    const cert_data_t * data = cert_get_data(head);
	    if (!data)
		break;
	    ptr = (u8*)cert_get_next_head(data);
	    if ( !ptr || ptr > end )
		break;

	    if ( cc == &global_cert )
		cert_add_root(data->issuer);

	    cert_item_t * item
		= cert_append_item( cc, data->issuer, data->key_id, uniq );
	    DASSERT(item);

	    item->sig_space	= cert_get_signature_space(ntohl(head->sig_type));
	    item->sig_size	= cert_get_signature_size(ntohl(head->sig_type));
	    item->key_size	= cert_get_pubkey_size(ntohl(data->key_type));
	    item->data_size	= ptr - (u8*)data;
	    item->cert_size	= ptr - start;

	    const u8 * raw	= MEMDUP(start,item->cert_size);
	    item->head		= (cert_head_t*)raw;
	    item->data		= (cert_data_t*)( raw + ( (u8*)data - start ));

	    PRINT("s=%04x k=%04x : d=%04x,04x c=%04x : t=%08x,%08x : %s . %s\n",
			item->sig_size, item->key_size,
			item->data_size, item->cert_size,
			ntohl(head->sig_type), ntohl(data->key_type),
			data->issuer, data->key_id );
	}
    }

    TRACE("N-CERT=%u->%u/%u\n",start_count,cc->used,cc->size);
    return cc->used - start_count;
}

///////////////////////////////////////////////////////////////////////////////

int cert_append_file
(
    cert_chain_t	* cc,		// valid pointer to cert chain
    ccp			filename,	// name of file
    bool		uniq		// true: avoid duplicates
)
{
    DASSERT(cc);
    char buf[0x10000];

    FILE * f = fopen(filename,"rb");
    if (!f)
	return -1;

    size_t stat = fread(buf,1,sizeof(buf),f);
    fclose(f);
    return stat ? cert_append_data(cc,buf,stat,uniq) : 0;
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			check certificate		///////////////
///////////////////////////////////////////////////////////////////////////////

cert_stat_t cert_check
(
    const cert_chain_t	* cc,		// NULL or pointer to cert chain
    const void		* sig_data,	// pointer to signature data
    u32			sig_data_size,	// size of 'sig_data'
    const cert_item_t	** cert_found	// not NULL: return value: found certificate
)
{
    TRACE("\n--- cert_check(%p,%p,%x=%u)\n", cc, sig_data, sig_data_size, sig_data_size );

    if (cert_found)
	*cert_found = 0;


    //--- is sig valid?

    if ( !sig_data || sig_data_size <= WII_CERT_ALIGN )
	return CERT_ERR_INVALID_SIG;

    if (!cert_get_signature_size(be32(sig_data)))
	return CERT_ERR_NOT_SUPPORTED;

    //HEXDUMP16(0,0,sig_data,16);
    const cert_head_t * head = sig_data;
    const cert_data_t * data = cert_get_data(sig_data);
    if (!data)
	return CERT_ERR_INVALID_SIG;

    const int test_data_size = sig_data_size - ( (u8*)data - (u8*)head );
    if ( test_data_size <= WII_CERT_ALIGN )
	return 0;

    TRACE("VALID: %s . %s\n", data->issuer, data->key_id );


    //--- find parent key in chain

 #if 1 || defined(TEST)
    const cert_item_t *item = FindCertItem(data->issuer,cc,true,true);
    PRINT("FindCertItem(%s): %s\n",data->issuer,item?item->name:"-");
    if (!item)
	return CERT_ERR_NOT_FOUND;

    PRINT("FOUND: %s . %s [%s]\n",
		item->data->issuer, item->data->key_id,
		item->head
			? cert_get_signature_name(ntohl(item->head->sig_type),"?")
			: "?" );
    if (cert_found)
	*cert_found = item;

    const u32 key_type = ntohl(item->data->key_type);
    const u32 sig_type = ntohl(head->sig_type);
    PRINT("%x %x %x\n",key_type,key_type|0x10000,sig_type);
    if ( (key_type|0x10000) != sig_type )
	return CERT_ERR_TYPE_MISSMATCH;

    //HEXDUMP16(0,0,data,test_data_size);
    u8 hash[WII_HASH_SIZE];
    SHA1((u8*)data,test_data_size,hash);
    //PRINT("HASH: "); HEXDUMP(0,0,0,-WII_HASH_SIZE,hash,WII_HASH_SIZE);

    bool sig_ok = false, fake_ok = false;
    bool res_is_sig = true; // otherwise 'hash'

    u8 buf[0x200];
    const int sig_len = cert_get_signature_size(sig_type);
    if ( sig_len > sizeof(buf) )
	return CERT_ERR_TYPE_MISSMATCH;

    const u8 *key = item->data->public_key;
    //HEXDUMP16(0,0,key,60);

    if ( key_type == 2 )
    {
	// special code for Elliptic Curve

	//HEXDUMP16(0,0,head->cert_data,60);
	const u8 *r = head->cert_data;	// first 30 bytes of signature
	const u8 *s = head->cert_data+30;	// second 30 bytes of signature

	u8 s_inv[30];
	u8 e[30];
	u8 w1[30], w2[30];
	u8 r1[60], r2[60];

	// order of the addition group of points
	static u8 ec_n[30] =
		"\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
		"\x13\xe9\x74\xe7\x2f\x8a\x69\x22\x03\x1d\x26\x03\xcf\xe0\xd7";

	// base point
	static u8 ec_g[60] =
		"\x00\xfa\xc9\xdf\xcb\xac\x83\x13\xbb\x21\x39\xf1\xbb\x75\x5f"
		"\xef\x65\xbc\x39\x1f\x8b\x36\xf8\xf8\xeb\x73\x71\xfd\x55\x8b"
		"\x01\x00\x6a\x08\xa4\x19\x03\x35\x06\x78\xe5\x85\x28\xbe\xbf"
		"\x8a\x0b\xef\xf8\x67\xa7\xca\x36\x71\x6f\x7e\x01\xf8\x10\x52";

 #if defined(TEST) && 0
    #define ESTIMATE_EC_TIME 10
    const u_usec_t start = GetTimeUSec(false);
    uint ii;
    for ( ii = 0; ii < ESTIMATE_EC_TIME; ii++ )
    {
 #endif
	bn_inv(s_inv,s,ec_n,30);
	elt_zero(e);
	memcpy( e+10, hash, 20 );
	bn_mul(w1, e, s_inv, ec_n, 30);
	bn_mul(w2, r, s_inv, ec_n, 30);
	point_mul(r1, w1, ec_g);
	point_mul(r2, w2, key);
	point_add(r1, r1, r2);

	if (bn_compare(r1, ec_n, 30) >= 0)
		bn_sub_modulus(r1, ec_n, 30);
	sig_ok = !bn_compare(r1,r,30);
 #if ESTIMATE_EC_TIME
    }
    printf("EC duration: %llu usec\n",(GetTimeUSec(false)-start)/ESTIMATE_EC_TIME);
 #endif
    }
    else
    {
	bn_exp(buf,head->cert_data,key,sig_len,key+sig_len,4);
	const u8 *h = buf + sig_len - WII_HASH_SIZE;
	sig_ok  = !memcmp(h,hash,WII_HASH_SIZE);
	fake_ok = !strncmp((ccp)h,(ccp)hash,WII_HASH_SIZE);
	//HEXDUMP16(0,0,buf,sig_len);

	static const u8 ber[16] = { 0x00,0x30,0x21,0x30,0x09,0x06,0x05,0x2b,
				    0x0e,0x03,0x02,0x1a,0x05,0x00,0x04,0x14 };
	const int ber_index = sig_len - 36;
	res_is_sig =  buf[0] == 0x00
		   && buf[1] == 0x01
		   && buf[2] == 0xff
		   && !memcmp(buf+2,buf+3,sig_len-ber_index-3)
		   && !memcmp(buf+ber_index,ber,sizeof(ber));
    }

    if (res_is_sig)
	return sig_ok ? CERT_SIG_OK
		    : fake_ok ? CERT_SIG_FAKE_SIGNED : CERT_SIG_FAILED;

    return sig_ok ? CERT_HASH_OK
		    : fake_ok ? CERT_FAKE_SIGNED : CERT_HASH_FAILED;

 #else // !TEST

    if (!cc)
	cc = &global_cert;

    for(;;)
    {    
	if ( cc == &global_cert )
	    cert_add_root();

	int c;
	for ( c = 0; c < cc->used; c++ )
	{
	    cert_item_t *item = cc->cert + c;
	    if (!strcmp(data->issuer,item->name))
	    {
		PRINT("FOUND: %s . %s [%s]\n",
			    item->data->issuer, item->data->key_id,
			    item->head
				? cert_get_signature_name(ntohl(item->head->sig_type),"?")
				: "?" );
		if (cert_found)
		    *cert_found = item;

		const u32 key_type = ntohl(item->data->key_type);
		const u32 sig_type = ntohl(head->sig_type);
		PRINT("%x %x %x\n",key_type,key_type|0x10000,sig_type);
		if ( (key_type|0x10000) != sig_type )
		    return CERT_ERR_TYPE_MISSMATCH;

		//HEXDUMP16(0,0,data,test_data_size);
		u8 hash[WII_HASH_SIZE];
		SHA1((u8*)data,test_data_size,hash);
		//PRINT("HASH: "); HEXDUMP(0,0,0,-WII_HASH_SIZE,hash,WII_HASH_SIZE);

		bool sig_ok = false, fake_ok = false;
		bool res_is_sig = true; // otherwise 'hash'

		u8 buf[0x200];
		const int sig_len = cert_get_signature_size(sig_type);
		if ( sig_len > sizeof(buf) )
		    return CERT_ERR_TYPE_MISSMATCH;

		const u8 *key = item->data->public_key;
		//HEXDUMP16(0,0,key,60);

		if ( key_type == 2 )
		{
		    // special code for Elliptic Curve

		    //HEXDUMP16(0,0,head->cert_data,60);
		    const u8 *r = head->cert_data;	// first 30 bytes of signature
		    const u8 *s = head->cert_data+30;	// second 30 bytes of signature

		    u8 s_inv[30];
		    u8 e[30];
		    u8 w1[30], w2[30];
		    u8 r1[60], r2[60];

		    // order of the addition group of points
		    static u8 ec_n[30] =
			"\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
			"\x13\xe9\x74\xe7\x2f\x8a\x69\x22\x03\x1d\x26\x03\xcf\xe0\xd7";

		    // base point
		    static u8 ec_g[60] =
			"\x00\xfa\xc9\xdf\xcb\xac\x83\x13\xbb\x21\x39\xf1\xbb\x75\x5f"
			"\xef\x65\xbc\x39\x1f\x8b\x36\xf8\xf8\xeb\x73\x71\xfd\x55\x8b"
			"\x01\x00\x6a\x08\xa4\x19\x03\x35\x06\x78\xe5\x85\x28\xbe\xbf"
			"\x8a\x0b\xef\xf8\x67\xa7\xca\x36\x71\x6f\x7e\x01\xf8\x10\x52";

    #if defined(TEST) && 0
		#define ESTIMATE_EC_TIME 10
		const u_usec_t start = GetTimeUSec(false);
		uint ii;
		for ( ii = 0; ii < ESTIMATE_EC_TIME; ii++ )
		{
    #endif
		    bn_inv(s_inv,s,ec_n,30);
		    elt_zero(e);
		    memcpy( e+10, hash, 20 );
		    bn_mul(w1, e, s_inv, ec_n, 30);
		    bn_mul(w2, r, s_inv, ec_n, 30);
		    point_mul(r1, w1, ec_g);
		    point_mul(r2, w2, key);
		    point_add(r1, r1, r2);

		    if (bn_compare(r1, ec_n, 30) >= 0)
			    bn_sub_modulus(r1, ec_n, 30);
		    sig_ok = !bn_compare(r1,r,30);
    #if ESTIMATE_EC_TIME
		}
		printf("EC duration: %llu usec\n",(GetTimeUSec(false)-start)/ESTIMATE_EC_TIME);
    #endif
		}
		else
		{
		    bn_exp(buf,head->cert_data,key,sig_len,key+sig_len,4);
		    const u8 *h = buf + sig_len - WII_HASH_SIZE;
		    sig_ok  = !memcmp(h,hash,WII_HASH_SIZE);
		    fake_ok = !strncmp((ccp)h,(ccp)hash,WII_HASH_SIZE);
		    //HEXDUMP16(0,0,buf,sig_len);

		    static const u8 ber[16] = { 0x00,0x30,0x21,0x30,0x09,0x06,0x05,0x2b,
						0x0e,0x03,0x02,0x1a,0x05,0x00,0x04,0x14 };
		    const int ber_index = sig_len - 36;
		    res_is_sig	=  buf[0] == 0x00
				&& buf[1] == 0x01
				&& buf[2] == 0xff
				&& !memcmp(buf+2,buf+3,sig_len-ber_index-3)
				&& !memcmp(buf+ber_index,ber,sizeof(ber));
		}


		if (res_is_sig)
		    return sig_ok ? CERT_SIG_OK
				: fake_ok ? CERT_SIG_FAKE_SIGNED : CERT_SIG_FAILED;

		return sig_ok ? CERT_HASH_OK
				: fake_ok ? CERT_FAKE_SIGNED : CERT_HASH_FAILED;
	    }
	}

	if ( cc == &global_cert )
	    return CERT_ERR_NOT_FOUND;
	cc = &global_cert;
    }
 #endif // !TEST
}

///////////////////////////////////////////////////////////////////////////////

cert_stat_t cert_check_cert
(
    const cert_chain_t	* cc,		// valid pointer to cert chain
    const cert_item_t	* item,		// NULL or pointer to certificate data
    const cert_item_t	** cert_found	// not NULL: return value: found certificate
)
{
    if ( !item || !item->head )
    {
	if (cert_found)
	    *cert_found = 0;
	return CERT_ERR_INVALID_SIG;
    }

    return cert_check(cc,item->head,item->cert_size,cert_found);
};

///////////////////////////////////////////////////////////////////////////////

cert_stat_t cert_check_ticket
(
    const cert_chain_t	* cc,		// valid pointer to cert chain
    const wd_ticket_t	* ticket,	// NULL or pointer to ticket
    const cert_item_t	** cert_found	// not NULL: return value: found certificate
)
{
    if (!ticket)
    {
	if (cert_found)
	    *cert_found = 0;
	return CERT_ERR_INVALID_SIG;
    }

    return cert_check(cc,ticket,sizeof(*ticket),cert_found);
};

///////////////////////////////////////////////////////////////////////////////

cert_stat_t cert_check_tmd
(
    const cert_chain_t	* cc,		// valid pointer to cert chain
    const wd_tmd_t	* tmd,		// NULL or pointer to tmd
    const cert_item_t	** cert_found	// not NULL: return value: found certificate
)
{
    if (!tmd)
    {
	if (cert_found)
	    *cert_found = 0;
	return CERT_ERR_INVALID_SIG;
    }

    const int tmd_size	= sizeof(wd_tmd_t)
			+ ntohs(tmd->n_content) * sizeof(wd_tmd_content_t);
    return cert_check(cc,tmd,tmd_size,cert_found);
};

//
///////////////////////////////////////////////////////////////////////////////
///////////////			    etc				///////////////
///////////////////////////////////////////////////////////////////////////////

u32 cert_fake_sign 
(
    cert_item_t		* item		// pointer to certificate
)
{
    DASSERT(item);
    if (!item->head)
	return 0;

    memset((u8*)item->head->cert_data,0,item->sig_size);

    u8 * addr = (u8*)item->data->public_key + item->key_size + 4;
    if ( addr > (u8*)item->data + item->data_size - 4 )
    {
	addr = (u8*)item->data->key_id + sizeof(item->data->key_id) - 4;
	addr[-1] = 0;
    }

    u32 val = 0;
    u8 hash[WII_HASH_SIZE];
    do
    {
	memcpy(addr,&val,sizeof(val));
	SHA1((u8*)item->data,item->data_size,hash);
	if (!*hash)
	    break;
	val++;

    } while (val);
    return val; 
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			    base64			///////////////
///////////////////////////////////////////////////////////////////////////////

uint CalcEncode64len
(
    // returns the needed buflen inclusive 0-Term

    uint	source_len,		// size of source data
    int		indent,			// >0: indent each line with spaces
    int		max_line_length,	// >0: force line breaks
    uint	*tupel_per_line		// not NULL: store num of tupel per line
)
{
    int dest_len = (( source_len + 2 ) / 3 ) * 4;
    int lines = 1;
    int max_tupel = INT_MAX;
    if ( max_line_length > 0 )
    {
	max_tupel = max_line_length / 4;
	if ( max_tupel < 1 )
	    max_tupel = 1;
	if (dest_len)
	{
	    lines = ( dest_len - 1 ) / ( 4 * max_tupel ) + 1;
	    dest_len += lines;
	}
    }

    if (tupel_per_line)
	*tupel_per_line = max_tupel;

    if ( indent > 0 )
	dest_len += lines * indent;
    return dest_len + 1; // add 0-term
}

///////////////////////////////////////////////////////////////////////////////

int Encode64buf
(
    // returns -1 if dest buffer is too small
    // otherwise it returns the number of written characters

    char	*buf,			// valid destination buffer
    uint	buf_size,		// size of buffer
    const void	*source,		// pointer to source data
    uint	source_len,		// size of source data
    int		indent,			// >0: indent each line with spaces
    int		max_line_length		// >0: force line breaks
)
{
    DASSERT(buf);
    DASSERT(source);

    uint tupel_per_line;
    uint dest_len = CalcEncode64len(source_len,indent,max_line_length,&tupel_per_line);
    if ( dest_len > buf_size )
	return -1;

    EncodeBase64ml(buf,buf_size,source,source_len,0,true,indent,0,0,tupel_per_line*3);
    return strlen(buf);
}

///////////////////////////////////////////////////////////////////////////////

char * Encode64
(
    // returns a null terminated string (alloced)

    const void	*source,		// pointer to source data
    uint	source_len,		// size of source data
    int		indent,			// >0: indent each line with spaces
    int		max_line_length,	// >0: force line breaks
    uint	*return_len		// not NULL: store strlen(result)
)
{
    const uint dest_len = CalcEncode64len(source_len,indent,max_line_length,0);
    DASSERT(dest_len>0);
    char *dest = MALLOC(dest_len);
    uint ret_len = Encode64buf(dest,dest_len,source,source_len,indent,max_line_length);
    if (return_len)
	*return_len = ret_len;
    return dest;
}

///////////////////////////////////////////////////////////////////////////////

uint PrintEncode64
(
    // returns a null terminated string (alloced)

    FILE	*f,			// destination file
    const void	*source,		// pointer to source data
    uint	source_len,		// size of source data
    int		indent,			// >0: indent each line with spaces
    int		max_line_length		// >0: force line breaks
)
{
    DASSERT(f);

    char tempbuf[4000];
    const uint dest_len = CalcEncode64len(source_len,indent,max_line_length,0);
    DASSERT(dest_len>0);
    char *dest = dest_len <= sizeof(tempbuf) ? tempbuf : MALLOC(dest_len);
    uint ret_len = Encode64buf(dest,dest_len,source,source_len,indent,max_line_length);
    fwrite(dest,1,ret_len,f);
    if ( dest != tempbuf )
	FREE(tempbuf);
    return ret_len;
}

//
///////////////////////////////////////////////////////////////////////////////
///////////////			    END				///////////////
///////////////////////////////////////////////////////////////////////////////

